:" KlongPy varaint of 1-flat.py "

d::64       :" dimension "
nb::100000  :" database size "
nq::10000   :" nb of queries "
.rns(1234)  :" make reproducible "

xb::(nb,d):^.rna(nb*d);1;
xq::(nq,d):^.rna(nq*d);1;
.d("#xq: ");.p(#xq)

.pyf("faiss";"IndexFlatL2")
index::IndexFlatL2(d)
add::.pya(index;"add")
search::.pya(index;"search")

.p(.pya(index,"is_trained"))

add(xb)
.pya(index;"ntotal")

k::4
DI::search(xq;k)
.d("DI: ");.p(DI)
