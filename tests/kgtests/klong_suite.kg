:"Klong test suite; nmh 2015--2020; public domain"

.comment("end-of-comment")
abcdefghijklmnopqrstuvwxyz
ABCDEFGHIJKLMNOPQRSTUVWXYZ
0123456789
~!@#$%^&*()_+-=`[]{}:;"'<,>.
end-of-comment

err::0
wl::{.w(x);.p("")}
fail::{err::1;.d("failed: ");.p(x);.d("expected: ");wl(z);.d("got: ");wl(y);[]}
t::{:[~y~z;fail(x;y;z);[]]}

rnd::{:[x<0;-1;1]*_0.5+#x}
rndn::{rnd(x*10^y)%10^y}

:" Atom "
t("@:foo"       ; @:foo     ; 1)
t("@0"          ; @0        ; 1)
t("@123"        ; @123      ; 1)
t("@-1"         ; @-1       ; 1)
t("@1.23"       ; @1.23     ; 1)
t("@1e5"        ; @1e5      ; 1)
t("@"""""       ; @""       ; 1)
t("@""string""" ; @"string" ; 0)
t("@[]"         ; @[]       ; 1)
t("@[1 2 3]"    ; @[1 2 3]  ; 0)
t("@{x}"        ; @{x}      ; 1)
t("@:{}"        ; @:{}      ; 1)
t("@:{[1 2]}"   ; @:{[1 2]} ; 1)

:" List "
t(",:foo"       ; ,:foo     ; [:foo])
t(",0"          ; ,0        ; [0])
t(",123"        ; ,123      ; [123])
t(",-1"         ; ,-1       ; [-1])
t(",1.23"       ; ,1.23     ; [1.23])
t(",1e5"        ; ,1e5      ; [1e5])
t(",0cx"        ; ,0cx      ; "x")
t(",""string""" ; ,"string" ; ["string"])
t(",[]"         ; ,[]       ; [[]])
t(",[1 2 3]"    ; ,[1 2 3]  ; [[1 2 3]])

:" Enumerate "
t("!0"  ; !0  ; [])
t("!1"  ; !1  ; [0])
t("!3"  ; !3  ; [0 1 2])
t("!10" ; !10 ; [0 1 2 3 4 5 6 7 8 9])

:" Size "
t("#0"               ; #0             ; 0)
t("#1"               ; #1             ; 1)
t("#123"             ; #123           ; 123)
t("#-123"            ; #-123          ; 123)
t("#[]"              ; #[]            ; 0)
t("#[1]"             ; #[1]           ; 1)
t("#[1 2 3 4 5]"     ; #[1 2 3 4 5]   ; 5)
t("#[[1] [2]]"       ; #[[1] [2]]     ; 2)
t("#:{}"             ; #:{}           ; 0)
t("#:{[1 2]}"        ; #:{[1 2]}      ; 1)
t("#"""""            ; #""            ; 0)
t("#""x"""           ; #"x"           ; 1)
t("#""hello world""" ; #"hello world" ; 11)

:" Grade-Down "
t(">[]"               ; >[]               ; [])
t(">[1]"              ; >[1]              ; [0])
t(">[1 2 3]"          ; >[1 2 3]          ; [2 1 0])
t(">[1 3 2]"          ; >[1 3 2]          ; [1 2 0])
t(">[2 1 3]"          ; >[2 1 3]          ; [2 0 1])
t(">[2 3 1]"          ; >[2 3 1]          ; [1 0 2])
t(">[3 1 2]"          ; >[3 1 2]          ; [0 2 1])
t(">[3 2 1]"          ; >[3 2 1]          ; [0 1 2])
t(">[0.0 0.1 -0.1]"   ; >[0.0 0.1 -0.1]   ; [1 0 2])
t(">[:foo :bar :baz]" ; >[:foo :bar :baz] ; [0 2 1])
t(">""foobar"""       ; >"foobar"         ; [5 2 1 0 3 4])
t(">[[0 1] [0 2]]"    ; >[[0 1] [0 2]]    ; [1 0])
t(">[[0 2] [0 1]]"    ; >[[0 2] [0 1]]    ; [0 1])

t(">[""this"" ""is"" ""a"" ""test""]" ; >["this" "is" "a" "test"] ; [0 3 1 2])

:" Grade-Up "
t("<[]"               ; <[]               ; [])
t("<[1]"              ; <[1]              ; [0])
t("<[1 2 3]"          ; <[1 2 3]          ; [0 1 2])
t("<[1 3 2]"          ; <[1 3 2]          ; [0 2 1])
t("<[2 1 3]"          ; <[2 1 3]          ; [1 0 2])
t("<[2 3 1]"          ; <[2 3 1]          ; [2 0 1])
t("<[3 1 2]"          ; <[3 1 2]          ; [1 2 0])
t("<[3 2 1]"          ; <[3 2 1]          ; [2 1 0])
t("<[0.0 0.1 -0.1]"   ; <[0.0 0.1 -0.1]   ; [2 0 1])
t("<[:foo :bar :baz]" ; <[:foo :bar :baz] ; [1 2 0])
t("<""foobar"""       ; <"foobar"         ; [4 3 0 1 2 5])
t("<[[0 1] [0 2]]"    ; <[[0 1] [0 2]]    ; [0 1])
t("<[[0 2] [0 1]]"    ; <[[0 2] [0 1]]    ; [1 0])

t("<[""this"" ""is"" ""a"" ""test""]" ; <["this" "is" "a" "test"] ; [2 1 3 0])

:" Group "
t("=[]"              ; =[]              ; [])
t("=[1]"             ; =[1]             ; [[0]])
t("=[1 2 3]"         ; =[1 2 3]         ; [[0] [1] [2]])
t("=[1 2 1 3 1 2 3]" ; =[1 2 1 3 1 2 3] ; [[0 2 4] [1 5] [3 6]])
t("=[1 1 1 1 1]"     ; =[1 1 1 1 1]     ; [[0 1 2 3 4]])
t("="""""            ; =""              ; [])
t("=""x"""           ; ="x"             ; [[0]])
t("=""abc"""         ; ="abc"           ; [[0] [1] [2]])
t("=""abacabc"""     ; ="abacabc"       ; [[0 2 4] [1 5] [3 6]])
t("=""xxxxx"""       ; ="xxxxx"         ; [[0 1 2 3 4]])

:" First "
t("*[]"      ; *[]      ; [])
t("*[1]"     ; *[1]     ; 1)
t("*[1 2 3]" ; *[1 2 3] ; 1)
t("*"""""    ; *""      ; "")
t("*""x"""   ; *"x"     ; 0cx)
t("*""abc""" ; *"abc"   ; 0ca)

:" Transpose "
t("+[]"                  ; +[]                  ; [])
t("+[1]"                 ; +[1]                 ; [1])
t("+[1 2 3]"             ; +[1 2 3]             ; [1 2 3])
t("+[[1 2 3]]"           ; +[[1 2 3]]           ; [[1] [2] [3]])
t("+[[1 2 3] [4 5 6]]"   ; +[[1 2 3] [4 5 6]]   ; [[1 4] [2 5] [3 6]])
t("+[[1 2] [3 4] [5 6]]" ; +[[1 2] [3 4] [5 6]] ; [[1 3 5] [2 4 6]])

:" Floor "
t("_0"     ; _0     ; 0)
t("_1"     ; _1     ; 1)
t("_1.23"  ; _1.23  ; 1)
t("_1.999" ; _1.999 ; 1)
t("_1e9"   ; _1e9   ; 1e9)
t("_-1"    ; _-1    ; -1)
t("_-1.23" ; _-1.23 ; -2)
t("_-1.99" ; _-1.99 ; -2)
t("_-1e9"  ; _-1e9  ; -1e9)

t("_[0 [1 2.2] -9.99]" ; _[0 [1 2.2] -9.99] ; [0 [1 2.0] -10.0])

:" Negate "
t("-0"    ; -0    ; 0)
t("-1"    ; -1    ; -1)
t("-1.23" ; -1.23 ; -1.23)
t("-1e9"  ; -1e9  ; -1e9)

t("-[0 [1] -1.23]" ; -[0 [1] -1.23] ; [0 [-1] 1.23])

:" Not "
t("~:foo"       ; ~:foo     ; 0)
t("~0"          ; ~0        ; 1)
t("~123"        ; ~123      ; 0)
t("~-1"         ; ~-1       ; 0)
t("~1.23"       ; ~1.23     ; 0)
t("~1e5"        ; ~1e5      ; 0)
t("0ca~0ca"     ; 0ca~0ca   ; 1)
t("0ca~0cb"     ; 0ca~0cb   ; 0)
t("0cb~0ca"     ; 0cb~0ca   ; 0)
t("~"""""       ; ~""       ; 1)
t("~""string""" ; ~"string" ; 0)
t("~[]"         ; ~[]       ; 1)
t("~[0]"        ; ~[0]      ; [1])
t("~[1 2 3]"    ; ~[1 2 3]  ; [0 0 0])
t("~{x}"        ; ~{x}      ; 0)
t("~:{}"        ; ~:{}      ; 0)
t("~:{[1 2]}"   ; ~:{[1 2]} ; 0)

t("~[0 1 [] [2] """" ""x""]" ; ~[0 1 [] [2] "" "x"] ; [1 0 1 [0] 1 0])

:" Format "
t("$0"        ; $0      ; "0")
t("$1"        ; $1      ; "1")
t("$1.23"     ; $1.23   ; "1.23")
t("$-1"       ; $-1     ; "-1")
t("$-1.23"    ; $-1.23  ; "-1.23")
t("$:foo"     ; $:foo   ; ":foo")
t("$0cx"      ; $0cx    ; "x")
t("$"""""     ; $""     ; "")
t("$""test""" ; $"test" ; "test")

t("$[""x"" [:y] 0]" ; $["x" [:y] 0] ; ["x" [":y"] "0"])

:" Range "
t("?[]"              ; ?[]              ; [])
t("?[1]"             ; ?[1]             ; [1])
t("?[1 2 3]"         ; ?[1 2 3]         ; [1 2 3])
t("?[1 2 1 3 1 2 3]" ; ?[1 2 1 3 1 2 3] ; [1 2 3])
t("?[1 1 1 1 1]"     ; ?[1 1 1 1 1]     ; [1])
t("?"""""            ; ?""              ; "")
t("?""x"""           ; ?"x"             ; "x")
t("?""abc"""         ; ?"abc"           ; "abc")
t("?""abacabc"""     ; ?"abacabc"       ; "abc")
t("?""xxxxx"""       ; ?"xxxxx"         ; "x")

:" Reciprocal "
t("%1"     ; %1     ; 1.0)
t("%2"     ; %2     ; 0.5)
t("%4"     ; %4     ; 0.25)
t("%10"    ; %10    ; 0.1)
t("%0.01"  ; %0.01  ; 100)
t("%0.1"   ; %0.1   ; 10)
t("%0.5"   ; %0.5   ; 2)
t("%-1"    ; %-1    ; -1.0)
t("%-2"    ; %-2    ; -0.5)
t("%-4"    ; %-4    ; -0.25)
t("%-10"   ; %-10   ; -0.1)
t("%-0.01" ; %-0.01 ; -100.0)
t("%-0.1"  ; %-0.1  ; -10.0)
t("%-0.5"  ; %-0.5  ; -2.0)

t("%[1 [-2] 3.5]" ; %[1 [-2] 0.5] ; [1.0 [-0.5] 2.0])

:" Reverse "
t("|[]"                ; |[]                ; [])
t("|[1]"               ; |[1]               ; [1])
t("|[1 2 3]"           ; |[1 2 3]           ; [3 2 1])
t("|[[1 2 3] [4 5 6]]" ; |[[1 2 3] [4 5 6]] ; [[4 5 6] [1 2 3]])
t("|"""""              ; |""                ; "")
t("|""a"""             ; |"a"               ; "a")
t("|""abc"""           ; |"abc"             ; "cba")
t("|""abcdef"""        ; |"abcdef"          ; "fedcba")

:" Shape "
t("^:foo"                  ; ^:foo                  ; 0)
t("^123"                   ; ^123                   ; 0)
t("^""string"""            ; ^"string"              ; [6])
t("^{x}"                   ; ^{x}                   ; 0)
t("^:{}"                   ; ^:{}                   ; 0)
t("^:{[1 2]}"              ; ^:{[1 2]}              ; 0)
t("^[]"                    ; ^[]                    ; 0)
t("^[1]"                   ; ^[1]                   ; [1])
t("^[1 2]"                 ; ^[1 2]                 ; [2])
t("^[1 2 3]"               ; ^[1 2 3]               ; [3])
t("^[[1 2] [3 4]]"         ; ^[[1 2] [3 4]]         ; [2 2])
t("^[[1 2 3] [4 5 6]]"     ; ^[[1 2 3] [4 5 6]]     ; [2 3])
t("^[[1 2] [3 4] [5 6]]"   ; ^[[1 2] [3 4] [5 6]]   ; [3 2])
t("^[[1] [2] [3] [4]]"     ; ^[[1] [2] [3] [4]]     ; [4 1])
t("^[[[1] [2]] [[3] [4]]]" ; ^[[[1] [2]] [[3] [4]]] ; [2 2 1])
t("^[""abc"" ""def""]"     ; ^["abc" "def"]         ; [2 3])

:" Expand / Where "
t("&0"       ; &0       ; [])
t("&1"       ; &1       ; [0])
t("&2"       ; &2       ; [0 0])
t("&10"      ; &10      ; [0 0 0 0 0 0 0 0 0 0])
t("&[0]"     ; &[0]     ; [])
t("&[1]"     ; &[1]     ; [0])
t("&[2]"     ; &[2]     ; [0 0])
t("&[1 2 3]" ; &[1 2 3] ; [0 1 1 2 2 2])
t("&[0 3]"   ; &[0 3]   ; [1 1 1])
t("&[3 0]"   ; &[3 0]   ; [0 0 0])
t("&[2 0 3]" ; &[2 0 3] ; [0 0 2 2 2])

:" Char "
t(":#65"           ; :#65           ; 0cA)
t(":#97"           ; :#97           ; 0ca)
t("#:#10"          ; #:#10          ; 10)
t(":#[65 66 67]"   ; :#[65 66 67]   ; [0cA 0cB 0cC])
t(":#[65 [66] 67]" ; :#[65 [66] 67] ; [0cA [0cB] 0cC])

:" Amend "
t("[]:=[]"                    ; []:=[]                 ; [])
t("[]:=[99]"                  ; []:=[99]               ; [])
t("[1]:=[2 0]"                ; [1]:=[2 0]             ; [2])
t("[1 2 3]:=[9]"              ; [1 2 3]:=[9]           ; [1 2 3])
t("[1 2 3]:=[9 0]"            ; [1 2 3]:=[9 0]         ; [9 2 3])
t("[1 2 3]:=[9 0 1]"          ; [1 2 3]:=[9 0 1]       ; [9 9 3])
t("[1 2 3]:=[9 0 1 2]"        ; [1 2 3]:=[9 0 1 2]     ; [9 9 9])
t("[1 [2] 3]:=[[9] 1]"        ; [1 [2] 3]:=[[9] 1]     ; [1 [9] 3])
t("[1 [2 3] 3]:=[[9 9] 1]"    ; [1 [2 3] 3]:=[[9 9] 1] ; [1 [9 9] 3])
t(""""":=[]"                  ; "":=[]                 ; "")
t(""""":=[1]"                 ; "":=[1]                ; "")
t("""x"":=[0c0 0]"            ; "x":=[0c0 0]           ; "0")
t("""abc"":=[0c_]"            ; "abc":=[0c_]           ; "abc")
t("""abc"":=[0c_ 0]"          ; "abc":=[0c_ 0]         ; "_bc")
t("""abc"":=[0c_ 0 1]"        ; "abc":=[0c_ 0 1]       ; "__c")
t("""abc"":=[0c_ 0 1 2]"      ; "abc":=[0c_ 0 1 2]     ; "___")
t(""""":=[""x""]"             ; "":=["x"]              ; "")
t("""x"":=[""y"" 0]"          ; "x":=["y" 0]           ; "y")
t("""abc"":=[""x""]"          ; "abc":=["x"]           ; "abc")
t("""abc"":=[""_"" 0]"        ; "abc":=["_" 0]         ; "_bc")
t("""abcabc"":=[""__"" 0 4]"  ; "abcabc":=["__" 0 4]   ; "__ca__")
t("""abcabc"":=[""xyz"" 0 3]" ; "abcabc":=["xyz" 0 3]  ; "xyzxyz")
t("""abx"":=[""cde"" 2]"      ; "abx":=["cde" 2]       ; "abcde")
t("""abc"":=[""def"" 3]"      ; "abc":=["def" 3]       ; "abcdef")

:" Amend-in-Depth "
t("[1 2 3]:-[9 0]"         ; [1 2 3]:-[9 0]         ; [9 2 3])
t("[1 2 3]:-[9 1]"         ; [1 2 3]:-[9 1]         ; [1 9 3])
t("[1 2 3]:-[9 2]"         ; [1 2 3]:-[9 2]         ; [1 2 9])
t("[[1 2] [3 4]]:-[9 0 0]" ; [[1 2] [3 4]]:-[9 0 0] ; [[9 2] [3 4]])
t("[[1 2] [3 4]]:-[9 0 1]" ; [[1 2] [3 4]]:-[9 0 1] ; [[1 9] [3 4]])
t("[[1 2] [3 4]]:-[9 1 0]" ; [[1 2] [3 4]]:-[9 1 0] ; [[1 2] [9 4]])
t("[[1 2] [3 4]]:-[9 1 1]" ; [[1 2] [3 4]]:-[9 1 1] ; [[1 2] [3 9]])

A::[[[0 1] [2 3]] [[4 5] [6 7]]]
t("A:-[:x 0 0 0]" ; A:-[:x 0 0 0] ; [[[:x 1] [2 3]] [[4 5] [6 7]]])
t("A:-[:x 0 0 1]" ; A:-[:x 0 0 1] ; [[[0 :x] [2 3]] [[4 5] [6 7]]])
t("A:-[:x 0 1 0]" ; A:-[:x 0 1 0] ; [[[0 1] [:x 3]] [[4 5] [6 7]]])
t("A:-[:x 0 1 1]" ; A:-[:x 0 1 1] ; [[[0 1] [2 :x]] [[4 5] [6 7]]])
t("A:-[:x 1 0 0]" ; A:-[:x 1 0 0] ; [[[0 1] [2 3]] [[:x 5] [6 7]]])
t("A:-[:x 1 0 1]" ; A:-[:x 1 0 1] ; [[[0 1] [2 3]] [[4 :x] [6 7]]])
t("A:-[:x 1 1 0]" ; A:-[:x 1 1 0] ; [[[0 1] [2 3]] [[4 5] [:x 7]]])
t("A:-[:x 1 1 1]" ; A:-[:x 1 1 1] ; [[[0 1] [2 3]] [[4 5] [6 :x]]])

:" Define "
A::1;               t("A::1"                 ; A ; 1)
A::[1 2 3];         t("A::[1 2 3]"           ; A ; [1 2 3])
A::"hello, world!"; t("A::""hello, world!""" ; A ; "hello, world!")
A:::foobar;         t("A:::foobar"           ; A ; :foobar)

:" Divide "
t("0%1"      ; 0%1      ; 0)
t("1%1"      ; 1%1      ; 1)
t("2%1"      ; 2%1      ; 2)
t("1%2"      ; 1%2      ; 0.5)
t("0%1.0"    ; 0%1.0    ; 0)
t("1%1.0"    ; 1%1.0    ; 1.0)
t("2%1.0"    ; 2%1.0    ; 2.0)
t("1%2.0"    ; 1%2.0    ; 0.5)
t("(-0)%1"   ; (-0)%1   ; 0)
t("(-1)%1"   ; (-1)%1   ; -1)
t("(-2)%1"   ; (-2)%1   ; -2)
t("(-1)%2"   ; (-1)%2   ; -0.5)
t("(-0)%1.0" ; (-0)%1.0 ; 0)
t("(-1)%1.0" ; (-1)%1.0 ; -1.0)
t("(-2)%1.0" ; (-2)%1.0 ; -2.0)
t("(-1)%2.0" ; (-1)%2.0 ; -0.5)

t("[1 2 3 4 5]%2."       ; [1 2 3 4 5]%2.       ; [0.5 1.0 1.5 2.0 2.5])
t("2.0%[2 4 8 10]"       ; 2.0%[2 4 8 10]       ; [1.0 0.5 0.25 0.2])
t("[10 [20] 30]%[1 2 3]" ; [10 [20] 30]%[1 2 3] ; [10 [10] 10])

:" Integer-Divide "
t("0:%1"    ; 0:%1    ; 0)
t("1:%1"    ; 1:%1    ; 1)
t("2:%1"    ; 2:%1    ; 2)
t("1:%2"    ; 1:%2    ; 0)
t("(-0):%1" ; (-0):%1 ; 0)
t("(-1):%1" ; (-1):%1 ; -1)
t("(-2):%1" ; (-2):%1 ; -2)
t("(-1):%2" ; (-1):%2 ; -0)

t("[1 2 3 4 5]:%2"        ; [1 2 3 4 5]:%2        ; [0 1 1 2 2])
t("100:%[2 4 8 10]"       ; 100:%[2 4 8 10]       ; [50 25 12 10])
t("[10 [20] 30]:%[1 2 3]" ; [10 [20] 30]:%[1 2 3] ; [10 [10] 10])

:" Drop "
t("0_[]"            ; 0_[]            ; [])
t("1_[]"            ; 1_[]            ; [])
t("10_[]"           ; 10_[]           ; [])
t("0_[1]"           ; 0_[1]           ; [1])
t("1_[1]"           ; 1_[1]           ; [])
t("10_[1]"          ; 10_[1]          ; [])
t("0_[1 2 3]"       ; 0_[1 2 3]       ; [1 2 3])
t("1_[1 2 3]"       ; 1_[1 2 3]       ; [2 3])
t("2_[1 2 3]"       ; 2_[1 2 3]       ; [3])
t("3_[1 2 3]"       ; 3_[1 2 3]       ; [])
t("4_[1 2 3]"       ; 4_[1 2 3]       ; [])
t("2_[[1] [2] [3]]" ; 2_[[1] [2] [3]] ; [[3]])
t("0_"""""          ; 0_""            ; "")
t("1_"""""          ; 1_""            ; "")
t("10_"""""         ; 10_""           ; "")
t("0_""a"""         ; 0_"a"           ; "a")
t("1_""a"""         ; 1_"a"           ; "")
t("10_""a"""        ; 10_"a"          ; "")
t("0_""abc"""       ; 0_"abc"         ; "abc")
t("1_""abc"""       ; 1_"abc"         ; "bc")
t("2_""abc"""       ; 2_"abc"         ; "c")
t("3_""abc"""       ; 3_"abc"         ; "")
t("4_""abc"""       ; 4_"abc"         ; "")
t(":foo_:{}"        ; :foo_:{}        ; :{})

t(":foo_:{[:foo bar] [:goo baz]}";:foo_:{[:foo bar] [:goo baz]};:{[:goo baz]})
t(":foo_:{[:goo baz]}"           ; :foo_:{[:goo baz]}          ;:{[:goo baz]})

:" Cut "
t("[]:_[]"              ; []:_[]            ; [[]])
t("[]:_[1]"             ; []:_[1]           ; [[1]])
t("[]:_[1 2 3]"         ; []:_[1 2 3]       ; [[1 2 3]])
t("0:_[]"               ; 0:_[]             ; [[]])
t("0:_[1]"              ; 0:_[1]            ; [[] [1]])
t("1:_[1]"              ; 1:_[1]            ; [[1] []])
t("[0]:_[]"             ; [0]:_[]           ; [[]])
t("[0 0]:_[]"           ; [0 0]:_[]         ; [[] []])
t("[0]:_[1]"            ; [0]:_[1]          ; [[] [1]])
t("[1]:_[1]"            ; [1]:_[1]          ; [[1] []])
t("[0 1]:_[1]"          ; [0 1]:_[1]        ; [[] [1] []])
t("[0]:_!10"            ; [0]:_!10          ; [[] [0 1 2 3 4 5 6 7 8 9]])
t("[10]:_!10"           ; [10]:_!10         ; [[0 1 2 3 4 5 6 7 8 9] []])
t("[1 4 7]:_!10"        ; [1 4 7]:_!10      ; [[0] [1 2 3] [4 5 6] [7 8 9]])
t("(!6):_!5"            ; (!6):_!5          ; [[] [0] [1] [2] [3] [4] []])
t("[]:_"""""            ; []:_""            ; [""])
t("[]:_""a"""           ; []:_"a"           ; ["a"])
t("[]:_""abc"""         ; []:_"abc"         ; ["abc"])
t("[0 0]:_""a"""        ; [0 0]:_"a"        ; ["" "" "a"])
t("0:_"""""             ; 0:_""             ; [""])
t("0:_""a"""            ; 0:_"a"            ; ["" "a"])
t("1:_""a"""            ; 1:_"a"            ; ["a" ""])
t("[0]:_""a"""          ; [0]:_"a"          ; ["" "a"])
t("[1]:_""a"""          ; [1]:_"a"          ; ["a" ""])
t("[0 1]:_""a"""        ; [0 1]:_"a"        ; ["" "a" ""])
t("[0]:_""abcdef"""     ; [0]:_"abcdef"     ; ["" "abcdef"])
t("[6]:_""abcdef"""     ; [6]:_"abcdef"     ; ["abcdef" ""])
t("[1 3 5]:_""abcdef""" ; [1 3 5]:_"abcdef" ; ["a" "bc" "de" "f"])
t("(!7):_""abcdef"""    ; (!7):_"abcdef"    ; ["" "a" "b" "c" "d" "e" "f" ""])

:" Equal "
t("0=0"               ; 0=0           ; 1)
t("1=1"               ; 1=1           ; 1)
t("123=123"           ; 123=123       ; 1)
t("1.23=1.23"         ; 1.23=1.23     ; 1)
t("(-1)=-1"           ; (-1)=-1       ; 1)
t("(-123)=-123"       ; (-123)=-123   ; 1)
t("(-1.23)=-1.23"     ; (-1.23)=-1.23 ; 1)
t("123.0=123"         ; 123.0=123     ; 1)
t("123=123.0"         ; 123=123.0     ; 1)
t("0=1"               ; 0=1           ; 0)
t("1=0"               ; 1=0           ; 0)
t("123=-123"          ; 123=-123      ; 0)
t("(-123)=123"        ; (-123)=123    ; 0)
t("1.23=123"          ; 1.23=123      ; 0)
t("123=1.23"          ; 123=1.23      ; 0)
t("0ca=0ca"           ; 0ca=0ca       ; 1)
t("0ca=0cz"           ; 0ca=0cz       ; 0)
t("0cz=0ca"           ; 0cz=0ca       ; 0)
t("""""="""""         ; ""=""         ; 1)
t("""x""=""x"""       ; "x"="x"       ; 1)
t("""x""=""y"""       ; "x"="y"       ; 0)
t("""y""=""x"""       ; "y"="x"       ; 0)
t("""test""=""test""" ; "test"="test" ; 1)
t("""test""=""tesz""" ; "test"="tesz" ; 0)
t("""tesz""=""test""" ; "tesz"="test" ; 0)
t("""test""=""tes"""  ; "test"="tes"  ; 0)
t("""tes""=""test"""  ; "tes"="test"  ; 0)
t(":foo=:foo"         ; :foo=:foo     ; 1)
t(":foo=:bar"         ; :foo=:bar     ; 0)
t(":bar=:foo"         ; :bar=:foo     ; 0)
t(":foo=:fob"         ; :foo=:fob     ; 0)
t(":fob=:foo"         ; :fob=:foo     ; 0)
t(":foo=:fo"          ; :foo=:fo      ; 0)
t(":fo=:foo"          ; :fo=:foo      ; 0)

t("[1 2 3]=[1 2 3]"           ; [1 2 3]=[1 2 3]           ; [1 1 1])
t("1=[1 1 1]"                 ; 1=[1 1 1]                 ; [1 1 1])
t("[1 1 1]=2"                 ; [1 1 1]=2                 ; [0 0 0])
t("[1 [2 [:x]]]=[1 [2 [:x]]]" ; [1 [2 [:x]]]=[1 [2 [:x]]] ; [1 [1 [1]]])
t("[1 [0 [:x]]]=[1 [2 [:x]]]" ; [1 [0 [:x]]]=[1 [2 [:x]]] ; [1 [0 [1]]])

:" Find "
t("[]?0"                  ; []?0                 ; [])
t("[0]?0"                 ; [0]?0                ; [0])
t("[0]?1"                 ; [0]?1                ; [])
t("[1]?0"                 ; [1]?0                ; [])
t("[1 2 3]?2"             ; [1 2 3]?2            ; [1])
t("[1 1 1]?1"             ; [1 1 1]?1            ; [0 1 2])
t("[1 2 1 2 1 2]?2"       ; [1 2 1 2 1 2]?2      ; [1 3 5])
t("[[1] [2] [3]]?[2]"     ; [[1] [2] [3]]?[2]    ; [1])
t("""""?0ca"              ; ""?0ca               ; [])
t("""a""?0ca"             ; "a"?0ca              ; [0])
t("""a""?0cb"             ; "a"?0cb              ; [])
t("""b""?0ca"             ; "b"?0ca              ; [])
t("""abc""?0cb"           ; "abc"?0cb            ; [1])
t("""aaa""?0ca"           ; "aaa"?0ca            ; [0 1 2])
t("""abcabcabc""?0cc"     ; "abcabcabc"?0cc      ; [2 5 8])
t("""""?"""""             ; ""?""                ; [0])
t("""""?""a"""            ; ""?"a"               ; [])
t("""a""?""a"""           ; "a"?"a"              ; [0])
t("""a""?""b"""           ; "a"?"b"              ; [])
t("""b""?""a"""           ; "b"?"a"              ; [])
t("""abc""?""b"""         ; "abc"?"b"            ; [1])
t("""aaa""?""a"""         ; "aaa"?"a"            ; [0 1 2])
t("""abcabcabc""?""abc""" ; "abcabcabc"?"abc"    ; [0 3 6])
t("""abbbbbbbc""?""bbb""" ; "abbbbbbbc"?"bbb"    ; [1 2 3 4 5])
t(":{}?:foo"              ; :{}?:foo             ; 1%0)
t(":{[:foo :bar]}?:foo"   ; :{[:foo :bar]}?:foo  ; :bar)
t(":{[:foo :bar]}?:bar"   ; :{[:foo :bar]}?:bar  ; 1%0)
t(":{[:foo :bar]}?123"    ; :{[:foo :bar]}?123   ; 1%0)

:" Format2 "
t("0$0"            ; 0$0         ; "0")
t("0$123"          ; 0$123       ; "123")
t("0$-123"         ; 0$-123      ; "-123")
t("0$1.23"         ; 0$1.23      ; "1.23")
t("0$-1.23"        ; 0$-1.23     ; "-1.23")
t("10$0"           ; 10$0        ; "0         ")
t("10$123"         ; 10$123      ; "123       ")
t("10$-123"        ; 10$-123     ; "-123      ")
t("10$1.23"        ; 10$1.23     ; "1.23      ")
t("10$-1.23"       ; 10$-1.23    ; "-1.23     ")
t("3$123"          ; 3$123       ; "123")
t("4$123"          ; 4$123       ; "123 ")
t("4$-123"         ; 4$-123      ; "-123")
t("5$-123"         ; 5$-123      ; "-123 ")
t("4$1.23"         ; 4$1.23      ; "1.23")
t("5$1.23"         ; 5$1.23      ; "1.23 ")
t("5$-1.23"        ; 5$-1.23     ; "-1.23")
t("6$-1.23"        ; 6$-1.23     ; "-1.23 ")
t("(-10)$0"        ; (-10)$0     ; "         0")
t("(-10)$123"      ; (-10)$123   ; "       123")
t("(-10)$-123"     ; (-10)$-123  ; "      -123")
t("(-10)$1.23"     ; (-10)$1.23  ; "      1.23")
t("(-10)$-1.23"    ; (-10)$-1.23 ; "     -1.23")
t("(-3)$123"       ; (-3)$123    ; "123")
t("(-4)$123"       ; (-4)$123    ; " 123")
t("(-4)$-123"      ; (-4)$-123   ; "-123")
t("(-5)$-123"      ; (-5)$-123   ; " -123")
t("(-4)$1.23"      ; (-4)$1.23   ; "1.23")
t("(-5)$1.23"      ; (-5)$1.23   ; " 1.23")
t("(-5)$-1.23"     ; (-5)$-1.23  ; "-1.23")
t("(-6)$-1.23"     ; (-6)$-1.23  ; " -1.23")
t("0$""test"""     ; 0$"test"    ; "test")
t("4$""test"""     ; 4$"test"    ; "test")
t("5$""test"""     ; 5$"test"    ; "test ")
t("10$""test"""    ; 10$"test"   ; "test      ")
t("(-4)$""test"""  ; (-4)$"test" ; "test")
t("(-5)$""test"""  ; (-5)$"test" ; " test")
t("(-10)$""test""" ; (-10)$"test"; "      test")
t("4$:foo"         ; 4$:foo      ; ":foo")
t("5$:foo"         ; 5$:foo      ; ":foo ")
t("10$:foo"        ; 10$:foo     ; ":foo      ")
t("(-4)$:foo"      ; (-4)$:foo   ; ":foo")
t("(-5)$:foo"      ; (-5)$:foo   ; " :foo")
t("(-10)$:foo"     ; (-10)$:foo  ; "      :foo")
t("0.0$123.45"     ; 0.0$123.45  ; "123.45")
t("3.2$123.45"     ; 3.2$123.45  ; "123.45")
t("4.2$123.45"     ; 4.2$123.45  ; " 123.45")
t("3.3$123.45"     ; 3.3$123.45  ; "123.450")
t("5.3$123.45"     ; 5.3$123.45  ; "  123.450")
t("0.0$-123.45"    ; 0.0$-123.45 ; "-123.45")
t("4.2$-123.45"    ; 4.2$-123.45 ; "-123.45")
t("5.2$-123.45"    ; 5.2$-123.45 ; " -123.45")
t("4.3$-123.45"    ; 4.3$-123.45 ; "-123.450")
t("6.3$-123.45"    ; 6.3$-123.45 ; "  -123.450")

:" Form "
t("0:$"""""        ; 0:$""        ; 1.0%0)
t("0.0:$"""""      ; 0.0:$""      ; 1.0%0)
t(":x:$"""""       ; :x:$""       ; 1.0%0)
t(""""":$"""""     ; "":$""       ; "")
t("0:$""123"""     ; 0:$"123"     ; 123)
t("0:$""-123"""    ; 0:$"-123"    ; -123)
t("0:$""1.23"""    ; 0:$"1.23"    ; 1.0%0)
t("0:$""-1.23"""   ; 0:$"-1.23"   ; 1.0%0)
t("0.0:$""123"""   ; 0.0:$"123"   ; 123.0)
t("0.0:$""-123"""  ; 0.0:$"-123"  ; -123.0)
t("0.0:$""1.23"""  ; 0.0:$"1.23"  ; 1.23)
t("0.0:$""-1.23""" ; 0.0:$"-1.23" ; -1.23)
t(":x:$""foo"""    ; :x:$"foo"    ; :foo)
t(":x:$"":foo"""   ; :x:$":foo"   ; :foo)
t("0c0:$"""""      ; 0c0:$""      ; 1.0%0)
t("0c0:$""x"""     ; 0c0:$"x"     ; 0cx)
t("0c0:$""xx"""    ; 0c0:$"xx"    ; 1.0%0)

t(""""":$""foo bar baz""" ; "":$"foo bar baz" ; "foo bar baz")

:" At / Index "
t("[]@[]"                    ; []@[]                  ; [])
t("[1]@[]"                   ; [1]@[]                 ; [])
t("[1]@0"                    ; [1]@0                  ; 1)
t("[1]@[0]"                  ; [1]@[0]                ; [1])
t("[1]@[0 0 0]"              ; [1]@[0 0 0]            ; [1 1 1])
t("(!10)@[1 3 5 9]"          ; (!10)@[1 3 5 9]        ; [1 3 5 9])
t("(!10)@!10"                ; (!10)@!10              ; [0 1 2 3 4 5 6 7 8 9])
t("[[1] [2] [3]]@[0 1 2]"    ; [[1] [2] [3]]@[0 1 2]  ; [[1] [2] [3]])
t("""""@[]"                  ; ""@[]                  ; "")
t("""x""@[]"                 ; "x"@[]                 ; "")
t("""x""@0"                  ; "x"@0                  ; 0cx)
t("""x""@[0]"                ; "x"@[0]                ; "x")
t("""x""@[0 0 0]"            ; "x"@[0 0 0]            ; "xxx")
t("""abcdefghij""@[1 3 5 9]" ; "abcdefghij"@[1 3 5 9] ; "bdfj")
t("""abcdefghij""@!9"        ; "abcdefghi"@!9         ; "abcdefghi")

:" At / Index "
t("{123}@[]"        ; {123}@[]        ; 123)
t("{x}@[456]"       ; {x}@[456]       ; 456)
t("{x+y}@[5 7]"     ; {x+y}@[5 7]     ; 12)
t("{x+y+z}@[5 7 9]" ; {x+y+z}@[5 7 9] ; 21)

:" Join "
t("0,1"                 ; 0,1             ; [0 1])
t("[],[]"               ; [],[]           ; [])
t("[0],[]"              ; [0],[]          ; [0])
t("[],[1]"              ; [],[1]          ; [1])
t("[0],[1]"             ; [0],[1]         ; [0 1])
t("[[0]],[1]"           ; [[0]],[1]       ; [[0] 1])
t("[0],[[1]]"           ; [0],[[1]]       ; [0 [1]])
t("[1 2 3],4"           ; [1 2 3],4       ; [1 2 3 4])
t("1,[2 3 4]"           ; 1,[2 3 4]       ; [1 2 3 4])
t("[1 2 3],[4 5 6]"     ; [1 2 3],[4 5 6] ; [1 2 3 4 5 6])
t(""""","""""           ; "",""           ; "")
t("""a"","""""          ; "a",""          ; "a")
t(""""",""b"""          ; "","b"          ; "b")
t("""a"",""b"""         ; "a","b"         ; "ab")
t("""abc"",0cd"         ; "abc",0cd       ; "abcd")
t("0ca,""bcd"""         ; 0ca,"bcd"       ; "abcd")
t("""abc"",""def"""     ; "abc","def"     ; "abcdef")
t("[""abc""],""def"""   ; ["abc"],"def"   ; ["abc" "def"])
t("""abc"",[""def""]"   ; "abc",["def"]   ; ["abc" "def"])
t("[""abc""],[""def""]" ; ["abc"],["def"] ; ["abc" "def"])

:" Less "
t("0<0"                ; 0<0            ; 0)
t("0<1"                ; 0<1            ; 1)
t("1<0"                ; 1<0            ; 0)
t("1<1"                ; 1<1            ; 0)
t("(-1)<0"             ; (-1)<0         ; 1)
t("(-1)<1"             ; (-1)<1         ; 1)
t("(-1)<-1"            ; (-1)<-1        ; 0)
t("0<-1"               ; 0<-1           ; 0)
t("1<-1"               ; 1<-1           ; 0)
t("1.23<4.56"          ; 1.23<4.56      ; 1)
t("(-1.23)<4.56"       ; (-1.23)<4.56   ; 1)
t("1.23<-4.56"         ; 1.23<-4.56     ; 0)
t("(-1.23)<-4.56"      ; (-1.23)<-4.56  ; 0)
t("4.56<1.23"          ; 4.56<1.23      ; 0)
t("(-4.56)<1.23"       ; (-4.56)<1.23   ; 1)
t("4.56<-1.23"         ; 4.56<-1.23     ; 0)
t("(-4.56)<-1.23"      ; (-4.56)<-1.23  ; 1)
t("123<123.0"          ; 123<123.0      ; 0)
t("123<123.1"          ; 123<123.1      ; 1)
t("123.0<123"          ; 123.0<123      ; 0)
t("123.1<123"          ; 123.1<123      ; 0)
t("123<123"            ; 123<123        ; 0)
t("0ca<0ca"            ; 0ca<0ca        ; 0)
t("0ca<0cz"            ; 0ca<0cz        ; 1)
t("0cz<0ca"            ; 0cz<0ca        ; 0)
t("""""<"""""          ; ""<""          ; 0)
t("""a""<""a"""        ; "a"<"a"        ; 0)
t("""a""<""b"""        ; "a"<"b"        ; 1)
t("""b""<""a"""        ; "b"<"a"        ; 0)
t("""b""<""b"""        ; "b"<"b"        ; 0)
t("""test""<""test"""  ; "test"<"test"  ; 0)
t("""tesz""<""test"""  ; "tesz"<"test"  ; 0)
t("""test""<""tesz"""  ; "test"<"tesz"  ; 1)
t("""tests""<""test""" ; "tests"<"test" ; 0)
t("""test""<""tests""" ; "test"<"tests" ; 1)
t(":foo<:foo"          ; :foo<:foo      ; 0)
t(":foo<:bar"          ; :foo<:bar      ; 0)
t(":bar<:foo"          ; :bar<:foo      ; 1)
t(":foo<:fob"          ; :foo<:fob      ; 0)
t(":fob<:foo"          ; :fob<:foo      ; 1)
t(":foo<:fooo"         ; :foo<:fooo     ; 1)
t(":fooo<:foo"         ; :fooo<:foo     ; 0)

t("[1 [3] 5]<[2 [3] 4]" ; [1 [3] 5]<[2 [3] 4] ; [1 [0] 0])

:" Match "
t("0~0"               ; 0~0           ; 1)
t("1~1"               ; 1~1           ; 1)
t("123~123"           ; 123~123       ; 1)
t("1.23~1.23"         ; 1.23~1.23     ; 1)
t("(-1)~-1"           ; (-1)~-1       ; 1)
t("(-123)~-123"       ; (-123)~-123   ; 1)
t("(-1.23)~-1.23"     ; (-1.23)~-1.23 ; 1)
t("123.0~123"         ; 123.0~123     ; 1)
t("123~123.0"         ; 123~123.0     ; 1)
t("0~1"               ; 0~1           ; 0)
t("1~0"               ; 1~0           ; 0)
t("123~-123"          ; 123~-123      ; 0)
t("(-123)~123"        ; (-123)~123    ; 0)
t("1.23~123"          ; 1.23~123      ; 0)
t("123~1.23"          ; 123~1.23      ; 0)
t("""""~"""""         ; ""~""         ; 1)
t("""x""~""x"""       ; "x"~"x"       ; 1)
t("""x""~""y"""       ; "x"~"y"       ; 0)
t("""y""~""x"""       ; "y"~"x"       ; 0)
t("""test""~""test""" ; "test"~"test" ; 1)
t("""test""~""tesz""" ; "test"~"tesz" ; 0)
t("""tesz""~""test""" ; "tesz"~"test" ; 0)
t("""test""~""tes"""  ; "test"~"tes"  ; 0)
t("""tes""~""test"""  ; "tes"~"test"  ; 0)
t(":foo~:foo"         ; :foo~:foo     ; 1)
t(":foo~:bar"         ; :foo~:bar     ; 0)
t(":bar~:foo"         ; :bar~:foo     ; 0)
t(":foo~:fob"         ; :foo~:fob     ; 0)
t(":fob~:foo"         ; :fob~:foo     ; 0)
t(":foo~:fo"          ; :foo~:fo      ; 0)
t(":fo~:foo"          ; :fo~:foo      ; 0)

t("[1 2 3]~[1 2 3]"               ; [1 2 3]~[1 2 3]               ; 1)
t("[1 2 3]~[0 2 3]"               ; [1 2 3]~[0 2 3]               ; 0)
t("[1 2 3]~[1 0 3]"               ; [1 2 3]~[1 0 3]               ; 0)
t("[1 2 3]~[1 2 0]"               ; [1 2 3]~[1 2 0]               ; 0)
t("[1 [2 [:x]]]~[1 [2 [:x]]]"     ; [1 [2 [:x]]]~[1 [2 [:x]]]     ; 1)
t("[1 [0 [:x]]]~[1 [2 [:x]]]"     ; [1 [0 [:x]]]~[1 [2 [:x]]]     ; 0)
t("[1 [2 [:x]]]~[0 [2 [:x]]]"     ; [0 [2 [:x]]]~[1 [2 [:x]]]     ; 0)
t("[1 [2 [:x]]]~[1 [2 [:y]]]"     ; [1 [2 [:y]]]~[1 [2 [:x]]]     ; 0)
t(":{[1 2] [3 4]}~:{[1 2] [3 4]}" ; :{[1 2] [3 4]}~:{[1 2] [3 4]} ; 1)
t(":{[1 2] [3 4]}~:{[3 4] [1 2]}" ; :{[1 2] [3 4]}~:{[3 4] [1 2]} ; 1)
t(":{[1 2] [3 4]}~:{[1 2] [0 4]}" ; :{[1 2] [3 4]}~:{[1 2] [0 4]} ; 0)
t(":{[1 2] [3 4]}~:{[1 0] [3 4]}" ; :{[1 2] [3 4]}~:{[1 0] [3 4]} ; 0)
t(":{[1 2]}~:{[1 2] [3 4]}"       ; :{[1 2]}~:{[1 2] [3 4]}       ; 0)
t(":{[1 2] [3 4]}~:{[3 4]}"       ; :{[1 2] [3 4]}~:{[3 4]}       ; 0)
t("123~:foo"                      ; 123~:foo                      ; 0)
t("123~""123"""                   ; 123~"123"                     ; 0)
t("123~[1 2 3]"                   ; 123~[1 2 3]                   ; 0)
t("123~:{[123 456]}"              ; 123~:{[123 456]}              ; 0)
t(":foo~123"                      ; :foo~123                      ; 0)
t("""123""~123"                   ; "123"~123                     ; 0)
t("[1 2 3]~123"                   ; [1 2 3]~123                   ; 0)
t(":{[123 456]}~123"              ; :{[123 456]}~123              ; 0)
t(":foo~""foo"""                  ; :foo~"foo"                    ; 0)
t(":foo~[f o o]"                  ; :foo~[f o o]                  ; 0)
t(":foo~:{[:foo :bar]}"           ; :foo~:{[:foo :bar]}           ; 0)
t("""foo""~:foo"                  ; "foo"~:foo                    ; 0)
t("[f o o]~:foo"                  ; [f o o]~:foo                  ; 0)
t(":{[:foo bar]}~:foo"            ; :{[:foo bar]}~:foo            ; 0)
t("[1 2 3]~""123"""               ; [1 2 3]~"123"                 ; 0)
t("[1 2 3]~:{[1 2]}"              ; [1 2 3]~:{[1 2]}              ; 0)
t("""123""~[1 2 3]"               ; "123"~[1 2 3]                 ; 0)
t(":{[1 2]}~[1 2]"                ; :{[1 2]}~[1 2]                ; 0)
t("""12""~:{[1 2]}"               ; "12"~:{[1 2]}                 ; 0)
t(":{[1 2]}~""12"""               ; :{[1 2]}~"12"                 ; 0)

:" Max "
t("0|0"           ; 0|0           ; 0)
t("0|1"           ; 0|1           ; 1)
t("1|0"           ; 1|0           ; 1)
t("1|1"           ; 1|1           ; 1)
t("123|456"       ; 123|456       ; 456)
t("123|-456"      ; 123|-456      ; 123)
t("(-123)|456"    ; (-123)|456    ; 456)
t("(-123)|-456"   ; (-123)|-456   ; -123)
t("456|123"       ; 456|123       ; 456)
t("456|-123"      ; 456|-123      ; 456)
t("(-456)|123"    ; (-456)|123    ; 123)
t("(-456)|-123"   ; (-456)|-123   ; -123)
t("1.23|4.56"     ; 1.23|4.56     ; 4.56)
t("1.23|-4.56"    ; 1.23|-4.56    ; 1.23)
t("(-1.23)|4.56"  ; (-1.23)|4.56  ; 4.56)
t("(-1.23)|-4.56" ; (-1.23)|-4.56 ; -1.23)
t("4.56|1.23"     ; 4.56|1.23     ; 4.56)
t("4.56|-1.23"    ; 4.56|-1.23    ; 4.56)
t("(-4.56)|1.23"  ; (-4.56)|1.23  ; 1.23)
t("(-4.56)|-1.23" ; (-4.56)|-1.23 ; -1.23)
t("123|123.1"     ; 123|123.1     ; 123.1)
t("123.1|123"     ; 123.1|123     ; 123.1)
t("[1 2 3 4]|2"     ; [1 2 3 4]|2     ; [2 2 3 4])
t("2|[1 2 3 4]"     ; 2|[1 2 3 4]     ; [2 2 3 4])
t("[1 5 3]|[4 2 6]" ; [1 5 3]|[4 2 6] ; [4 5 6])
t("[1 [2] 3]|2"     ; [1 [2] 3]|2     ; [2 [2] 3])

:" Min "
t("0&0"             ; 0&0             ; 0)
t("0&1"             ; 0&1             ; 0)
t("1&0"             ; 1&0             ; 0)
t("1&1"             ; 1&1             ; 1)
t("123&456"         ; 123&456         ; 123)
t("123&-456"        ; 123&-456        ; -456)
t("(-123)&456"      ; (-123)&456      ; -123)
t("(-123)&-456"     ; (-123)&-456     ; -456)
t("456&123"         ; 456&123         ; 123)
t("456&-123"        ; 456&-123        ; -123)
t("(-456)&123"      ; (-456)&123      ; -456)
t("(-456)&-123"     ; (-456)&-123     ; -456)
t("1.23&4.56"       ; 1.23&4.56       ; 1.23)
t("1.23&-4.56"      ; 1.23&-4.56      ; -4.56)
t("(-1.23)&4.56"    ; (-1.23)&4.56    ; -1.23)
t("(-1.23)&-4.56"   ; (-1.23)&-4.56   ; -4.56)
t("4.56&1.23"       ; 4.56&1.23       ; 1.23)
t("4.56&-1.23"      ; 4.56&-1.23      ; -1.23)
t("(-4.56)&1.23"    ; (-4.56)&1.23    ; -4.56)
t("(-4.56)&-1.23"   ; (-4.56)&-1.23   ; -4.56)
t("123&123.1"       ; 123&123.1       ; 123)
t("123.1&123"       ; 123.1&123       ; 123)
t("[1 2 3 4]&2"     ; [1 2 3 4]&2     ; [1 2 2 2])
t("2&[1 2 3 4]"     ; 2&[1 2 3 4]     ; [1 2 2 2])
t("[1 5 3]&[4 2 6]" ; [1 5 3]&[4 2 6] ; [1 2 3])
t("[1 [2] 3]&2"     ; [1 [2] 3]&2     ; [1 [2] 2])

:" Minus "
t("0-0"             ; 0-0             ; 0)
t("0-1"             ; 0-1             ; -1)
t("1-0"             ; 1-0             ; 1)
t("1-1"             ; 1-1             ; 0)
t("456-123"         ; 456-123         ; 333)
t("456--123"        ; 456--123        ; 579)
t("(-456)-123"      ; (-456)-123      ; -579)
t("(-456)--123"     ; (-456)--123     ; -333)
t("123-456"         ; 123-456         ; -333)
t("123--456"        ; 123--456        ; 579)
t("(-123)-456"      ; (-123)-456      ; -579)
t("(-123)--456"     ; (-123)--456     ; 333)
t("4.56-1.23"       ; 4.56-1.23       ; 3.33)
t("4.56--1.23"      ; 4.56--1.23      ; 5.79)
t("(-4.56)-1.23"    ; (-4.56)-1.23    ; -5.79)
t("(-4.56)--1.23"   ; (-4.56)--1.23   ; -3.33)
t("1.23-4.56"       ; 1.23-4.56       ; -3.33)
t("1.23--4.56"      ; 1.23--4.56      ; 5.79)
t("(-1.23)-4.56"    ; (-1.23)-4.56    ; -5.79)
t("(-1.23)--4.56"   ; (-1.23)--4.56   ; 3.33)
t("[1 2 3 4]-1"     ; [1 2 3 4]-1     ; [0 1 2 3])
t("1-[1 2 3 4]"     ; 1-[1 2 3 4]     ; [0 -1 -2 -3])
t("[1 2 3]-[4 5 6]" ; [1 2 3]-[4 5 6] ; [-3 -3 -3])
t("[1 [2] 3]-1"     ; [1 [2] 3]-1     ; [0 [1] 2])

:" More "
t("0>0"                 ; 0>0                 ; 0)
t("0>1"                 ; 0>1                 ; 0)
t("1>0"                 ; 1>0                 ; 1)
t("1>1"                 ; 1>1                 ; 0)
t("(-1)>0"              ; (-1)>0              ; 0)
t("(-1)>1"              ; (-1)>1              ; 0)
t("(-1)>-1"             ; (-1)>-1             ; 0)
t("0>-1"                ; 0>-1                ; 1)
t("1>-1"                ; 1>-1                ; 1)
t("1.23>4.56"           ; 1.23>4.56           ; 0)
t("(-1.23)>4.56"        ; (-1.23)>4.56        ; 0)
t("1.23>-4.56"          ; 1.23>-4.56          ; 1)
t("(-1.23)>-4.56"       ; (-1.23)>-4.56       ; 1)
t("4.56>1.23"           ; 4.56>1.23           ; 1)
t("(-4.56)>1.23"        ; (-4.56)>1.23        ; 0)
t("4.56>-1.23"          ; 4.56>-1.23          ; 1)
t("(-4.56)>-1.23"       ; (-4.56)>-1.23       ; 0)
t("123>123.0"           ; 123>123.0           ; 0)
t("123>123.1"           ; 123>123.1           ; 0)
t("123.0>123"           ; 123.0>123           ; 0)
t("123.1>123"           ; 123.1>123           ; 1)
t("123>123"             ; 123>123             ; 0)
t("0ca>0ca"             ; 0ca>0ca             ; 0)
t("0ca>0cz"             ; 0ca>0cz             ; 0)
t("0cz>0ca"             ; 0cz>0ca             ; 1)
t(""""">"""""           ; "">""               ; 0)
t("""a"">""a"""         ; "a">"a"             ; 0)
t("""a"">""b"""         ; "a">"b"             ; 0)
t("""b"">""a"""         ; "b">"a"             ; 1)
t("""b"">""b"""         ; "b">"b"             ; 0)
t("""test"">""test"""   ; "test">"test"       ; 0)
t("""tesz"">""test"""   ; "tesz">"test"       ; 1)
t("""test"">""tesz"""   ; "test">"tesz"       ; 0)
t("""tests"">""test"""  ; "tests">"test"      ; 1)
t("""test"">""tests"""  ; "test">"tests"      ; 0)
t(":foo>:foo"           ; :foo>:foo           ; 0)
t(":foo>:bar"           ; :foo>:bar           ; 1)
t(":bar>:foo"           ; :bar>:foo           ; 0)
t(":foo>:fob"           ; :foo>:fob           ; 1)
t(":fob>:foo"           ; :fob>:foo           ; 0)
t(":foo>:fooo"          ; :foo>:fooo          ; 0)
t(":fooo>:foo"          ; :fooo>:foo          ; 1)
t("[1 [3] 5]>[2 [3] 4]"        ; [1 [3] 5]>[2 [3] 4]        ; [0 [0] 1])

:" Plus "
t("0+0"                    ; 0+0                    ; 0)
t("0+1"                    ; 0+1                    ; 1)
t("1+0"                    ; 1+0                    ; 1)
t("1+1"                    ; 1+1                    ; 2)
t("456+123"                ; 456+123                ; 579)
t("456+-123"               ; 456+-123               ; 333)
t("(-456)+123"             ; (-456)+123             ; -333)
t("(-456)+-123"            ; (-456)+-123            ; -579)
t("123+456"                ; 123+456                ; 579)
t("123+-456"               ; 123+-456               ; -333)
t("(-123)+456"             ; (-123)+456             ; 333)
t("(-123)+-456"            ; (-123)+-456            ; -579)
t("4.56+1.23"              ; 4.56+1.23              ; 5.79)
t("4.56+-1.23"             ; 4.56+-1.23             ; 3.33)
t("(-4.56)+1.23"           ; (-4.56)+1.23           ; -3.33)
t("(-4.56)+-1.23"          ; (-4.56)+-1.23          ; -5.79)
t("1.23+4.56"              ; 1.23+4.56              ; 5.79)
t("1.23+-4.56"             ; 1.23+-4.56             ; -3.33)
t("(-1.23)+4.56"           ; (-1.23)+4.56           ; 3.33)
t("(-1.23)+-4.56"          ; (-1.23)+-4.56          ; -5.79)
t("[1 2 3 4]+1"            ; [1 2 3 4]+1            ; [2 3 4 5])
t("1+[1 2 3 4]"            ; 1+[1 2 3 4]            ; [2 3 4 5])
t("[1 2 3]+[4 5 6]"        ; [1 2 3]+[4 5 6]        ; [5 7 9])
t("[1 [2] 3]+1"            ; [1 [2] 3]+1            ; [2 [3] 4])

:" Power "
t("0^0"             ; (:_0^0)|1~0^0      ; 1)
t("0^1"             ; 0^1                ; 0)
t("0^2"             ; 0^2                ; 0)
t("0^3"             ; 0^3                ; 0)
t("1^0"             ; 1^0                ; 1)
t("1^1"             ; 1^1                ; 1)
t("1^2"             ; 1^2                ; 1)
t("1^3"             ; 1^3                ; 1)
t("2^0"             ; 2^0                ; 1)
t("2^1"             ; 2^1                ; 2)
t("2^2"             ; 2^2                ; 4)
t("2^3"             ; 2^3                ; 8)
t("2^-1"            ; 2^-1               ; 0.5)
t("2^-2"            ; 2^-2               ; 0.25)
t("2^-3"            ; 2^-3               ; 0.125)
t("(-1)^0"          ; (-1)^0             ; 1)
t("(-1)^1"          ; (-1)^1             ; -1)
t("(-1)^2"          ; (-1)^2             ; 1)
t("(-1)^3"          ; (-1)^3             ; -1)
t("(-2)^0"          ; (-2)^0             ; 1)
t("(-2)^1"          ; (-2)^1             ; -2)
t("(-2)^2"          ; (-2)^2             ; 4)
t("(-2)^3"          ; (-2)^3             ; -8)
t("(-1)^-1"         ; (-1)^-1            ; -1)
t("(-1)^-2"         ; (-1)^-2            ; 1)
t("(-1)^-3"         ; (-1)^-3            ; -1)
t("(-2)^-1"         ; (-2)^-1            ; -0.5)
t("(-2)^-2"         ; (-2)^-2            ; 0.25)
t("(-2)^-3"         ; (-2)^-3            ; -0.125)
t("[1 2 [3] 4 5]^2" ; [1 2 [3] 4 5]^2    ; [1 4 [9] 16 25])
t("2^[1 2 [3] 4 5]" ; 2^[1 2 [3] 4 5]    ; [2 4 [8] 16 32])
t("1^0.5"           ; 1^0.5              ; 1)
t("4^0.5"           ; rndn(4^0.5;10)     ; 2)
t("16^0.25"         ; rndn(16^0.25;10)   ; 2)
t("256^0.125"       ; rndn(256^0.125;10) ; 2)

:" Rotate "
t("0:+0"             ; 0:+0           ; 0)
t("1:+0"             ; 1:+0           ; 0)
t("2:+0"             ; 2:+0           ; 0)
t("(-1):+0"          ; (-1):+0        ; 0)
t("(-2):+0"          ; (-2):+0        ; 0)
t("0:+[]"            ; 0:+[]          ; [])
t("1:+[]"            ; 1:+[]          ; [])
t("2:+[]"            ; 2:+[]          ; [])
t("(-2):+[]"         ; (-2):+[]       ; [])
t("(-1):+[]"         ; (-1):+[]       ; [])
t("0:+[1]"           ; 0:+[1]         ; [1])
t("1:+[1]"           ; 1:+[1]         ; [1])
t("2:+[1]"           ; 2:+[1]         ; [1])
t("(-2):+[1]"        ; (-2):+[1]      ; [1])
t("(-1):+[1]"        ; (-1):+[1]      ; [1])
t("0:+!5"            ; 0:+!5          ; [0 1 2 3 4])
t("1:+!5"            ; 1:+!5          ; [4 0 1 2 3])
t("2:+!5"            ; 2:+!5          ; [3 4 0 1 2])
t("(-2):+!5"         ; (-2):+!5       ; [2 3 4 0 1])
t("(-1):+!5"         ; (-1):+!5       ; [1 2 3 4 0])
t("5:+!5"            ; 5:+!5          ; [0 1 2 3 4])
t("(-5):+!5"         ; (-5):+!5       ; [0 1 2 3 4])
t("12:+!5"           ; 12:+!5         ; [3 4 0 1 2])
t("(-12):+!5"        ; (-12):+!5      ; [2 3 4 0 1])
t("0:+"""""          ; 0:+""          ; "")
t("1:+"""""          ; 1:+""          ; "")
t("2:+"""""          ; 2:+""          ; "")
t("(-1):+"""""       ; (-1):+""       ; "")
t("(-2):+"""""       ; (-2):+""       ; "")
t("0:+""x"""         ; 0:+"x"         ; "x")
t("1:+""x"""         ; 1:+"x"         ; "x")
t("2:+""x"""         ; 2:+"x"         ; "x")
t("(-1):+""x"""      ; (-1):+"x"      ; "x")
t("(-2):+""x"""      ; (-2):+"x"      ; "x")
t("0:+""abcdef"""    ; 0:+"abcdef"    ; "abcdef")
t("1:+""abcdef"""    ; 1:+"abcdef"    ; "fabcde")
t("2:+""abcdef"""    ; 2:+"abcdef"    ; "efabcd")
t("(-1):+""abcdef""" ; (-1):+"abcdef" ; "bcdefa")
t("(-2):+""abcdef""" ; (-2):+"abcdef" ; "cdefab")
t("8:+""abcdef"""    ; 8:+"abcdef"    ; "efabcd")
t("(-8):+""abcdef""" ; (-8):+"abcdef" ; "cdefab")

:" Remainder "
t("0!1"      ; 0!1      ; 0)
t("1!1"      ; 1!1      ; 0)
t("2!1"      ; 2!1      ; 0)
t("1!2"      ; 1!2      ; 1)
t("17!5"     ; 17!5     ; 2)
t("(-17)!5"  ; (-17)!5  ; -2)
t("17!-5"    ; 17!-5    ; 2)
t("(-17)!-5" ; (-17)!-5 ; -2)
t("246!123"  ; 246!123  ; 0)
t("123!123"  ; 123!123  ; 0)

:" Take "
t("0#[]"            ; 0#[]          ; [])
t("1#[]"            ; 1#[]          ; [])
t("3#[]"            ; 3#[]          ; [])
t("0#[1]"           ; 0#[1]         ; [])
t("1#[1]"           ; 1#[1]         ; [1])
t("3#[1]"           ; 3#[1]         ; [1 1 1])
t("(-1)#[1]"        ; (-1)#[1]      ; [1])
t("(-3)#[1]"        ; (-3)#[1]      ; [1 1 1])
t("0#!5"            ; 0#!5          ; [])
t("1#!5"            ; 1#!5          ; [0])
t("5#!5"            ; 5#!5          ; [0 1 2 3 4])
t("9#!5"            ; 9#!5          ; [0 1 2 3 4 0 1 2 3])
t("(-1)#!5"         ; (-1)#!5       ; [4])
t("(-3)#!5"         ; (-3)#!5       ; [2 3 4])
t("(-7)#!5"         ; (-7)#!5       ; [3 4 0 1 2 3 4])
t("0#"""""          ; 0#""          ; "")
t("1#"""""          ; 1#""          ; "")
t("3#"""""          ; 3#""          ; "")
t("0#""x"""         ; 0#"x"         ; "")
t("1#""x"""         ; 1#"x"         ; "x")
t("3#""x"""         ; 3#"x"         ; "xxx")
t("(-1)#""x"""      ; (-1)#"x"      ; "x")
t("(-3)#""x"""      ; (-3)#"x"      ; "xxx")
t("0#""abcdef"""    ; 0#"abcdef"    ; "")
t("1#""abcdef"""    ; 1#"abcdef"    ; "a")
t("3#""abcdef"""    ; 3#"abcdef"    ; "abc")
t("10#""abcdef"""   ; 10#"abcdef"   ; "abcdefabcd")
t("(-1)#""abcdef""" ; (-1)#"abcdef" ; "f")
t("(-3)#""abcdef""" ; (-3)#"abcdef" ; "def")
t("(-9)#""abcdef""" ; (-9)#"abcdef" ; "defabcdef")

:" Reshape "
t("0:^1"             ; 0:^1             ; 1)
t("0:^[]"            ; 0:^[]            ; [])
t("0:^[1 2 3]"       ; 0:^[1 2 3]       ; [1 2 3])
t("1:^1"             ; 1:^1             ; [1])
t("2:^1"             ; 2:^1             ; [1 1])
t("5:^1"             ; 5:^1             ; [1 1 1 1 1])
t("[1]:^1"           ; [1]:^1           ; [1])
t("[2]:^1"           ; [2]:^1           ; [1 1])
t("[5]:^1"           ; [5]:^1           ; [1 1 1 1 1])
t("[1 1]:^1"         ; [1 1]:^1         ; [[1]])
t("[1 1 1]:^1"       ; [1 1 1]:^1       ; [[[1]]])
t("[2 2 2]:^1"       ; [2 2 2]:^1       ; [[[1 1] [1 1]] [[1 1] [1 1]]])
t("1:^!10"           ; 1:^!10           ; [0])
t("3:^!10"           ; 3:^!10           ; [0 1 2])
t("[3]:^!10"         ; [3]:^!10         ; [0 1 2])
t("[3 3]:^!10"       ; [3 3]:^!10       ; [[0 1 2] [3 4 5] [6 7 8]])
t("5:^[[1 2] [3 4]]" ; 5:^[[1 2] [3 4]] ; [[1 2] [3 4] [1 2] [3 4] [1 2]])
t("[2 2]:^[1 2 3 4]" ; [2 2]:^[1 2 3 4] ; [[1 2] [3 4]])
t("[3 3]:^[1 2 3 4]" ; [3 3]:^[1 2 3 4] ; [[1 2 3] [4 1 2] [3 4 1]])
t("[2 -1]:^!8"       ; [2 -1]:^!8       ; [[0 1 2 3] [4 5 6 7]])
t("[-1 2]:^!8"       ; [-1 2]:^!8       ; [[0 1] [2 3] [4 5] [6 7]])
t("[2 -1]:^!7"       ; [2 -1]:^!7       ; [[0 1 2] [3 4 5]])
t("[-1 2]:^!7"       ; [-1 2]:^!7       ; [[0 1] [2 3] [4 5]])
t("0:^""foo"""       ; 0:^"foo"         ; "foo")
t("1:^""x"""         ; 1:^"x"           ; "x")
t("1:^""xyz"""       ; 1:^"xyz"         ; "x")
t("3:^""xyz"""       ; 3:^"xyz"         ; "xyz")
t("[3]:^""xyz"""     ; [3]:^"xyz"       ; "xyz")
t("[3 3]:^""xyz"""   ; [3 3]:^"xyz"     ; ["xyz" "xyz" "xyz"])
t("[5 2]:^""xyz"""   ; [5 2]:^"xyz"     ; ["xy" "zx" "yz" "xy" "zx"])
t("[2 5]:^""xyz"""   ; [2 5]:^"xyz"     ; ["xyzxy" "zxyzx"])

t("[3 -1]:^!10" ; [3 -1]:^!10 ; [[0 1 2 3 4] [5 6 7 8 9] [0 1 2 3 4]])
t("[-1 3]:^!10" ; [-1 3]:^!10 ; [[0 1 2] [3 4 5] [6 7 8] [9 0 1] [2 3 4]])

:" Split "
t("1:#[]"      ; 1:#[]      ; [])
t("1:#[1]"     ; 1:#[1]     ; [[1]])
t("1:#[1 2]"   ; 1:#[1 2]   ; [[1] [2]])
t("1:#[1 2 3]" ; 1:#[1 2 3] ; [[1] [2] [3]])
t("2:#[1 2 3]" ; 2:#[1 2 3] ; [[1 2] [3]])
t("3:#[1 2 3]" ; 3:#[1 2 3] ; [[1 2 3]])
t("4:#[1 2 3]" ; 4:#[1 2 3] ; [[1 2 3]])
t("[2]:#!10"   ; [2]:#!10   ; [[0 1] [2 3] [4 5] [6 7] [8 9]])
t("[2 3]:#!10" ; [2 3]:#!10 ; [[0 1] [2 3 4] [5 6] [7 8 9]])
t("1:#"""""    ; 1:#""      ; [])
t("1:#""x"""   ; 1:#"x"     ; ["x"])
t("1:#""xy"""  ; 1:#"xy"    ; ["x" "y"])
t("1:#""xyz""" ; 1:#"xyz"   ; ["x" "y" "z"])
t("2:#""xyz""" ; 2:#"xyz"   ; ["xy" "z"])
t("3:#""xyz""" ; 3:#"xyz"   ; ["xyz"])
t("4:#""xyz""" ; 4:#"xyz"   ; ["xyz"])

t("[2]:#""abcdefghijk"""; [2]:#"abcdefghijk"; ["ab" "cd" "ef" "gh" "ij" "k"])
t("[2 3]:#""abcdefghijk"""; [2 3]:#"abcdefghijk"; ["ab" "cde" "fg" "hij" "k"])

:" Undefined "
t(":_:foo"       ; :_:foo       ; 0)
t(":_0"          ; :_0          ; 0)
t(":_123"        ; :_123        ; 0)
t(":_-1"         ; :_-1         ; 0)
t(":_1.23"       ; :_1.23       ; 0)
t(":_1e5"        ; :_1e5        ; 0)
t(":_"""""       ; :_""         ; 0)
t(":_""string""" ; :_"string"   ; 0)
t(":_[]"         ; :_[]         ; 0)
t(":_[1 2 3]"    ; :_[1 2 3]    ; 0)
t(":_{x}"        ; :_{x}        ; 0)
t(":_:{}"        ; :_:{}        ; 0)
t(":_:{[1 2]}"   ; :_:{[1 2]}   ; 0)
t(":_1.0%0.0"    ; :_1.0%0.0    ; 1)
t(":_1.0%0"      ; :_1.0%0      ; 1)
t(":_0%0.0"      ; :_1%0.0      ; 1)
t(":_1%0"        ; :_1%0        ; 1)
t(":_:{[1 2]}?3" ; :_:{[1 2]}?3 ; 1)

:" Times "
t("0*0"             ; 0*0             ; 0)
t("0*1"             ; 0*1             ; 0)
t("1*0"             ; 1*0             ; 0)
t("1*1"             ; 1*1             ; 1)
t("456*123"         ; 456*123         ; 56088)
t("456*-123"        ; 456*-123        ; -56088)
t("(-456)*123"      ; (-456)*123      ; -56088)
t("(-456)*-123"     ; (-456)*-123     ; 56088)
t("123*456"         ; 123*456         ; 56088)
t("123*-456"        ; 123*-456        ; -56088)
t("(-123)*456"      ; (-123)*456      ; -56088)
t("(-123)*-456"     ; (-123)*-456     ; 56088)
t("4.56*1.23"       ; 4.56*1.23       ; 5.6088)
t("4.56*-1.23"      ; 4.56*-1.23      ; -5.6088)
t("(-4.56)*1.23"    ; (-4.56)*1.23    ; -5.6088)
t("(-4.56)*-1.23"   ; (-4.56)*-1.23   ; 5.6088)
t("1.23*4.56"       ; 1.23*4.56       ; 5.6088)
t("1.23*-4.56"      ; 1.23*-4.56      ; -5.6088)
t("(-1.23)*4.56"    ; (-1.23)*4.56    ; -5.6088)
t("(-1.23)*-4.56"   ; (-1.23)*-4.56   ; 5.6088)
t("[1 2 3 4]*3"     ; [1 2 3 4]*3     ; [3 6 9 12])
t("3*[1 2 3 4]"     ; 3*[1 2 3 4]     ; [3 6 9 12])
t("[1 2 3]*[4 5 6]" ; [1 2 3]*[4 5 6] ; [4 10 18])
t("[1 [2] 3]*3"     ; [1 [2] 3]*3     ; [3 [6] 9])

:" Each "
D:::{[1 2] [3 4] [5 6]}
t(",'[]"                   ; ,'[]                   ; [])
t(",'[1]"                  ; ,'[1]                  ; [[1]])
t(",'[1 2 3]"              ; ,'[1 2 3]              ; [[1] [2] [3]])
f::{x*x}
t("f'[]"                   ; f'[]                   ; [])
t("f'[2]"                  ; f'[2]                  ; [4])
t("f'[2 3 4]"              ; f'[2 3 4]              ; [4 9 16])
t("{x+1}'[]"               ; {x+1}'[]               ; [])
t("{x+1}'[1]"              ; {x+1}'[1]              ; [2])
t("{x+1}'[1 2 3]"          ; {x+1}'[1 2 3]          ; [2 3 4])
t("*':{}"                  ; *':{}                  ; [])
t("*':{[1 2]}"             ; *':{[1 2]}             ; [1])
t("*':{[1 2] [3 4] [5 6]}" ; s@<s::*'D              ; [1 3 5])
t("{1_x}':{}"              ; {1_x}':{}              ; [])
t("{1_x}':{[1 2]}"         ; {1_x}':{[1 2]}         ; [[2]])
t("#'"""""                 ; #'""                   ; "")
t("{x}'"""""               ; {x}'""                 ; "")
t("#'""test"""             ; #'"test"               ; [116 101 115 116])
t("{x}'""foof"""           ; {x}'"foof"             ; "foof")
t("{x;0cx}'""test"""       ; {x;0cx}'"test"         ; "xxxx")
t("{x;-1}'""test"""        ; {x;-1}'"test"          ; [-1 -1 -1 -1])

t("{1_x}':{[1 2] [3 4] [5 6]}" ; s@<s::{1_x}'D ; [[2] [4] [6]])

:" Each2 "
t("[],'[]"                 ; [],'[]               ; [])
t("[1],'[2]"               ; [1],'[2]             ; [[1 2]])
t("[1 2 3],'[4 5 6]"       ; [1 2 3],'[4 5 6]     ; [[1 4] [2 5] [3 6]])
t("[]{y-x}'[]"             ; []{y-x}'[]           ; [])
t("[1]{y-x}'[2]"           ; [1]{y-x}'[2]         ; [1])
t("[1 2 3]{y-x}'[4 5 6]"   ; [1 2 3]{y-x}'[4 5 6] ; [3 3 3])
t("""""+'"""""             ; ""+'""               ; "")
t("""""{x+y}'"""""         ; ""{x+y}'""           ; "")
t("""test""{x;y}'""foof""" ; "test"{x;y}'"foof"   ; "foof")
t("""test""{y;x}'""foof""" ; "test"{y;x}'"foof"   ; "test")
t("""tst"",'""foo"""       ; "tst",'"foo"         ; ["tf" "so" "to"])

:" Each-Left "
t("0,:\[]"              ; 0,:\[]              ; [])
t("0,:\[1]"             ; 0,:\[1]             ; [[0 1]])
t("0,:\[1 2 3]"         ; 0,:\[1 2 3]         ; [[0 1] [0 2] [0 3]])
t("0{(,,x),y}:\[]"      ; 0{(,,x),y}:\[]      ; [])
t("0{(,,x),y}:\[1]"     ; 0{(,,x),y}:\[1]     ; [[[0] 1]])
t("0{(,,x),y}:\[1 2 3]" ; 0{(,,x),y}:\[1 2 3] ; [[[0] 1] [[0] 2] [[0] 3]])
t("1{x-#y}:\""test"""   ; 1{x-#y}:\"test"     ; [-115 -100 -114 -115])
t("0c!,:\""test"""      ; 0c!,:\"test"        ; ["!t" "!e" "!s" "!t"])

:" Each-Right "
t("0,:/[]"              ; 0,:/[]              ; [])
t("0,:/[1]"             ; 0,:/[1]             ; [[1 0]])
t("0,:/[1 2 3]"         ; 0,:/[1 2 3]         ; [[1 0] [2 0] [3 0]])
t("0{(,,x),y}:/[]"      ; 0{(,,x),y}:/[]      ; [])
t("0{(,,x),y}:/[1]"     ; 0{(,,x),y}:/[1]     ; [[[1] 0]])
t("0{(,,x),y}:/[1 2 3]" ; 0{(,,x),y}:/[1 2 3] ; [[[1] 0] [[2] 0] [[3] 0]])
t("1{(#x)-y}:/""test""" ; 1{(#x)-y}:/"test"   ; [115 100 114 115])
t("0c!,:/""test"""      ; 0c!,:/"test"        ; ["t!" "e!" "s!" "t!"])

:" Each-Pair "
t(",:'[]"       ; ,:'[]      ; [])
t(",:'[1]"      ; ,:'[1]     ; [1])
t(",:'[1 2]"    ; ,:'[1 2]   ; [[1 2]])
t(",:'[1 2 3]"  ; ,:'[1 2 3] ; [[1 2] [2 3]])
t("-:'!5"       ; -:'!5      ; [-1 -1 -1 -1])
f::{y,x}
t("f:'[]"       ; f:'[]      ; [])
t("f:'[1]"      ; f:'[1]     ; [1])
t("f:'!5"       ; f:'!5      ; [[1 0] [2 1] [3 2] [4 3]])
t("{y-x}:'[]"   ; {y-x}:'[]  ; [])
t("{y-x}:'[1]"  ; {y-x}:'[1] ; [1])
t("{y-x}:'!5"   ; {y-x}:'!5  ; [1 1 1 1])
t(",:'"""""     ; ,:'""      ; "")
t(",:'""x"""    ; ,:'"x"     ; "x")
t(",:'""test""" ; ,:'"test"  ; ["te" "es" "st"])

:" Over "
t(",/[]"           ; ,/[]           ; [])
t(",/[1]"          ; ,/[1]          ; 1)
t(",/[1 2]"        ; ,/[1 2]        ; [1 2])
t(",/[1 2 3]"      ; ,/[1 2 3]      ; [1 2 3])
t("-/[1 2 3]"      ; -/[1 2 3]      ; -4)
f::{y-x}
t("f/[]"           ; f/[]           ; [])
t("f/[1]"          ; f/[1]          ; 1)
t("f/[1 2]"        ; f/[1 2]        ; 1)
t("f/[1 2 3]"      ; f/[1 2 3]      ; 2)
t("{(,x),y}/[]"    ; {(,x),y}/[]    ; [])
t("{(,x),y}/[1]"   ; {(,x),y}/[1]   ; 1)
t("{(,x),y}/[1 2]" ; {(,x),y}/[1 2] ; [1 2])
t("{(,x),y}/!5"    ; {(,x),y}/!5    ; [[[[0 1] 2] 3] 4])
t("+/"""""         ; +/""           ; "")
t(",/"""""         ; ,/""           ; "")
t(",/""a"""        ; ,/"a"          ; 0ca)
t(",/""abc"""      ; ,/"abc"        ; "abc")

:" Over-Neutral "
t("1,/2"            ; 1,/2            ; [1 2])
t("[],/[]"          ; [],/[]          ; [])
t("[],/[1]"         ; [],/[1]         ; [1])
t("[],/[1 2]"       ; [],/[1 2]       ; [1 2])
t("[],/[1 2 3]"     ; [],/[1 2 3]     ; [1 2 3])
t("4+/[1 2 3]"      ; 4+/[1 2 3]      ; 10)
t("5{(,x),y}/[]"    ; 5{(,x),y}/[]    ; 5)
t("5{(,x),y}/[1]"   ; 5{(,x),y}/[1]   ; [5 1])
t("5{(,x),y}/[1 2]" ; 5{(,x),y}/[1 2] ; [[5 1] 2])
t("5{(,x),y}/!5"    ; 5{(,x),y}/!5    ; [[[[[5 0] 1] 2] 3] 4])
t("0c0,/"""""       ; 0c0,/""         ; 0c0)
t("0c0,/""a"""      ; 0c0,/"a"        ; "0a")
t("0c0,/""abc"""    ; 0c0,/"abc"      ; "0abc")

:" Converge "
t(",/:~[]"              ; ,/:~[]              ; [])
t(",/:~[1]"             ; ,/:~[1]             ; 1)
t(",/:~[1 2 3]"         ; ,/:~[1 2 3]         ; [1 2 3])
t(",/:~[1 [2] 3]"       ; ,/:~[1 [2] 3]       ; [1 2 3])
t(",/:~[[1] [[2]] [3]]" ; ,/:~[[1] [[2]] [3]] ; [1 2 3])
t(",/:~[[[[[0]]]]]"     ; ,/:~[[[[[0]]]]]     ; 0)
t("{_x%2}:~0"           ; {_x%2}:~0           ; 0)
t("{_x%2}:~1"           ; {_x%2}:~1           ; 0)
t("{_x%2}:~1000"        ; {_x%2}:~1000        ; 0)

:" Iterate "
t("0,:*1"      ; 0,:*1      ; 1)
t("1,:*1"      ; 1,:*1      ; [1])
t("2,:*1"      ; 2,:*1      ; [[1]])
t("3,:*1"      ; 3,:*1      ; [[[1]]])
t("0{1,x}:*[]" ; 0{1,x}:*[] ; [])
t("1{1,x}:*[]" ; 1{1,x}:*[] ; [1])
t("2{1,x}:*[]" ; 2{1,x}:*[] ; [1 1])
t("5{1,x}:*[]" ; 5{1,x}:*[] ; [1 1 1 1 1])

:" While "
t("{x;0}{x}:~0"                ; {x;0}{x}:~0                ; 0)
t("{x<0}{x+1}:~0"              ; {x<0}{x+1}:~0              ; 0)
t("{x<1}{x+1}:~0"              ; {x<1}{x+1}:~0              ; 1)
t("{x<10}{x+1}:~0"             ; {x<10}{x+1}:~0             ; 10)
t("{(#x)<5}{x,x}:~[1 2 3 4 5]" ; {(#x)<5}{x,x}:~[1 2 3 4 5] ; [1 2 3 4 5])
t("{(#x)<5}{1,x}:~1"           ; {(#x)<5}{1,x}:~1           ; [1 1 1 1 1])

:" Scan-Over "
t(",\[]"           ; ,\[]           ; [])
t(",\[1]"          ; ,\[1]          ; [1])
t(",\[1 2]"        ; ,\[1 2]        ; [1 [1 2]])
t(",\[1 2 3]"      ; ,\[1 2 3]      ; [1 [1 2] [1 2 3]])
t("-\[1 2 3]"      ; -\[1 2 3]      ; [1 -1 -4])
f::{y-x}
t("f\[]"           ; f\[]           ; [])
t("f\[1]"          ; f\[1]          ; [1])
t("f\[1 2]"        ; f\[1 2]        ; [1 1])
t("f\[1 2 3]"      ; f\[1 2 3]      ; [1 1 2])
t("{(,x),y}\[]"    ; {(,x),y}\[]    ; [])
t("{(,x),y}\[1]"   ; {(,x),y}\[1]   ; [1])
t("{(,x),y}\[1 2]" ; {(,x),y}\[1 2] ; [1 [1 2]])
t("{(,x),y}\!4"    ; {(,x),y}\!4    ; [0 [0 1] [[0 1] 2] [[[0 1] 2] 3]])
t("+\"""""         ; +\""           ; "")
t(",\"""""         ; ,\""           ; "")
t(",\""a"""        ; ,\"a"          ; [0ca])
t(",\""abc"""      ; ,\"abc"        ; [0ca "ab" "abc"])

:" Scan-Over-Neutral "
t("1,\2"            ; 1,\2            ; [1 [1 2]])
t("[],\[]"          ; [],\[]          ; [])
t("[],\[1]"         ; [],\[1]         ; [[] [1]])
t("[],\[1 2]"       ; [],\[1 2]       ; [[] [1] [1 2]])
t("[],\[1 2 3]"     ; [],\[1 2 3]     ; [[] [1] [1 2] [1 2 3]])
t("4+\[1 2 3]"      ; 4+\[1 2 3]      ; [4 5 7 10])
t("5{(,x),y}\[]"    ; 5{(,x),y}\[]    ; 5)
t("5{(,x),y}\[1]"   ; 5{(,x),y}\[1]   ; [5 [5 1]])
t("5{(,x),y}\[1 2]" ; 5{(,x),y}\[1 2] ; [5 [5 1] [[5 1] 2]])
t("3{(,x),y}\!3"    ; 3{(,x),y}\!3    ; [3 [3 0] [[3 0] 1] [[[3 0] 1] 2]])
t("0cz,\"""""       ; 0cz,\""         ; 0cz)
t("0c0,\""a"""      ; 0c0,\"a"        ; [0c0 "0a"])
t("0c0,\""abc"""    ; 0c0,\"abc"      ; [0c0 "0a" "0ab" "0abc"])

:" Scan-Converging "
t(",/\~[]"            ; ,/\~[]            ; [[]])
t(",/\~[1]"           ; ,/\~[1]           ; [[1] 1])
t(",/\~[1 2 3]"       ; ,/\~[1 2 3]       ; [[1 2 3]])
t(",/\~[1 [2] 3]"     ; ,/\~[1 [2] 3]     ; [[1 [2] 3] [1 2 3]])
t(",/\~[[1] [2] [3]]" ; ,/\~[[1] [2] [3]] ; [[[1] [2] [3]] [1 2 3]])
t(",/\~[[[0]]]"       ; ,/\~[[[0]]]       ; [[[[0]]] [[0]] [0] 0])
t("{_x%2}\~0"         ; {_x%2}\~0         ; [0])
t("{_x%2}\~1"         ; {_x%2}\~1         ; [1 0])

t("{_x%2}\~1000" ; {_x%2}\~1000 ; [1000 500 250 125 62 31 15 7 3 1 0])

:" Scan-Iterating "
t("0,\*1"      ; 0,\*1      ; 1)
t("1,\*1"      ; 1,\*1      ; [1 [1]])
t("2,\*1"      ; 2,\*1      ; [1 [1] [[1]]])
t("3,\*1"      ; 3,\*1      ; [1 [1] [[1]] [[[1]]]])
t("0{1,x}\*[]" ; 0{1,x}\*[] ; [])
t("1{1,x}\*[]" ; 1{1,x}\*[] ; [[] [1]])
t("2{1,x}\*[]" ; 2{1,x}\*[] ; [[] [1] [1 1]])
t("5{1,x}\*[]" ; 5{1,x}\*[] ; [[] [1] [1 1] [1 1 1] [1 1 1 1] [1 1 1 1 1]])

:" Scan-While "
t("{x;0}{x}\~0"      ; {x;0}{x}\~0      ; [])
t("{x<0}{x+1}\~0"    ; {x<0}{x+1}\~0    ; [])
t("{x<1}{x+1}\~0"    ; {x<1}{x+1}\~0    ; [0])
t("{x<10}{x+1}\~0"   ; {x<10}{x+1}\~0   ; [0 1 2 3 4 5 6 7 8 9])
t("{(#x)<5}{1,x}\~1" ; {(#x)<5}{1,x}\~1 ; [1 [1 1] [1 1 1] [1 1 1 1]])

t("{(#x)<5}{x,x}\~[1 2 3 4 5]" ; {(#x)<5}{x,x}\~[1 2 3 4 5] ; [])

:" Conditional "
t(":[0;1;2]"           ;:[0;1;2]           ;2)
t(":[0.0;1;2]"         ;:[0.0;1;2]         ;2)
t(":[[];1;2]"          ;:[[];1;2]          ;2)
t(":["""";1;2]"        ;:["";1;2]          ;2)
t(":[1;2;3]"           ;:[1;2;3]           ;2)
t(":[0.1;2;3]"         ;:[0.1;2;3]         ;2)
t(":[""x"";2;3]"       ;:["x";2;3]         ;2)
t(":[:foo;2;3]"        ;:[:foo;2;3]        ;2)
t(":[:{};2;3]"         ;:[:{};2;3]         ;2)
t(":[[1];2;3]"         ;:[[1];2;3]         ;2)
t(":[0;:[0;1;2];3]"    ;:[0;:[0;1;2];3]    ;3)
t(":[0;:[1;1;2];3]"    ;:[0;:[1;1;2];3]    ;3)
t(":[1;:[0;1;2];3]"    ;:[1;:[0;1;2];3]    ;2)
t(":[1;:[1;1;2];3]"    ;:[1;:[1;1;2];3]    ;1)
t(":[0;1:|2;3;4]"      ;:[0;1:|2;3;4]      ;3)
t(":[0.0;1:|2;3;4]"    ;:[0.0;1:|2;3;4]    ;3)
t(":[[];1:|2;3;4]"     ;:[[];1:|2;3;4]     ;3)
t(":["""";1:|2;3;4]"   ;:["";1:|2;3;4]     ;3)
t(":[1;2:|2;3;4]"      ;:[1;2:|2;3;4]      ;2)
t(":[0.1;2:|2;3;4]"    ;:[0.1;2:|2;3;4]    ;2)
t(":[""x"";2:|2;3;4]"  ;:["x";2:|2;3;4]    ;2)
t(":[:foo;2:|2;3;4]"   ;:[:foo;2:|2;3;4]   ;2)
t(":[:{};2:|2;3;4]"    ;:[:{};2:|2;3;4]    ;2)
t(":[[1];2:|2;3;4]"    ;:[[1];2:|2;3;4]    ;2)
t(":[0;2:|0;3;4]"      ;:[0;2:|0;3;4]      ;4)
t(":[0;2:|1;3;4]"      ;:[0;2:|1;3;4]      ;3)
t(":[1;2:|0;3;4]"      ;:[1;2:|0;3;4]      ;2)
t(":[1;2:|1;3;4]"      ;:[1;2:|1;3;4]      ;2)
t(":[0;2:|0;3:|0;4;5]" ;:[0;2:|0;3:|0;4;5] ;5)

:"Function Application"
t("{0}:()"     ; {0}:()     ;0)
t("{1,2,3}:()" ; {1,2,3}:() ;[1 2 3])
t("{x}:(1)"    ; {x}:(1)    ;1)

t("{0}:()"                ; {0}:()                ; 0)
t("{1,2,3}:()"            ; {1,2,3}:()            ; [1 2 3])
t("{x}:(1)"               ; {x}:(1)               ; 1)
t("{x,x}:(1)"             ; {x,x}:(1)             ; [1 1])
t("{x,x,x}:(1)"           ; {x,x,x}:(1)           ; [1 1 1])
t("{(x+1),(x+2),x+3}:(1)" ; {(x+1),(x+2),x+3}:(1) ; [2 3 4])
t("{x,y}:(1;2)"           ; {x,y}:(1;2)           ; [1 2])
t("{(x+y),x+y}:(1;2)"     ; {(x+y),x+y}:(1;2)     ; [3 3])
t("{x,y,z}:(1;2;3)"       ; {x,y,z}:(1;2;3)       ; [1 2 3])
t("{x,x,y,y,z,z}:(1;2;3)" ; {x,x,y,y,z,z}:(1;2;3) ; [1 1 2 2 3 3])
t("{x;y;z}:(1;2;3)"       ; {x;y;z}:(1;2;3)       ; 3)
t("{*/1+!x}:(10)"         ; {*/1+!x}:(10)         ; 3628800)

f0::{123}
t("f0()"      ; f0();123)

f1::{:[x=0;[];1,f1(x-1)]}
t("f1(0)"  ; f1(0)  ; [])
t("f1(1)"  ; f1(1)  ; [1])
t("f1(2)"  ; f1(2)  ; [1 1])
t("f1(10)" ; f1(10) ; [1 1 1 1 1 1 1 1 1 1])

f1b::{:[x=0;1;(,f1b(x-1)),,f1b(x-1)]}
t("f1b(0)" ; f1b(0) ; 1)
t("f1b(1)" ; f1b(1) ; [1 1])
t("f1b(2)" ; f1b(2) ; [[1 1] [1 1]])
t("f1b(3)" ; f1b(3) ; [[[1 1] [1 1]] [[1 1] [1 1]]])

f2::{:[0=y;1;x*f2(x;y-1)]}
t("f2(1;0)" ; f2(1;0) ; 1)
t("f2(2;0)" ; f2(2;0) ; 1)
t("f2(3;0)" ; f2(3;0) ; 1)
t("f2(2;1)" ; f2(2;1) ; 2)
t("f2(2;2)" ; f2(2;2) ; 4)
t("f2(2;5)" ; f2(2;5) ; 32)

f3::{:[0=x;:[y=0;z;f3(x;y-1;z+1)];f3(x-1;y;z+1)]}

t("f3(0;0;0)" ; f3(0;0;0) ; 0)
t("f3(0;0;3)" ; f3(0;0;3) ; 3)
t("f3(0;3;3)" ; f3(0;3;3) ; 6)
t("f3(3;0;0)" ; f3(3;0;0) ; 3)
t("f3(3;0;3)" ; f3(3;0;3) ; 6)
t("f3(3;3;0)" ; f3(3;3;0) ; 6)
t("f3(3;3;3)" ; f3(3;3;3) ; 9)

fr::{:[0=x;[];1,.f(x-1)]}
t("fr(0)"  ; fr(0)  ; [])
t("fr(1)"  ; fr(1)  ; [1])
t("fr(3)"  ; fr(3)  ; [1 1 1])
t("fr(10)" ; fr(10) ; [1 1 1 1 1 1 1 1 1 1])

:" Projection "
t("{x-y}:(1;)@2"        ; {x-y}:(1;)@2        ; -1)
t("{x-y}:(;2)@2"        ; {x-y}:(;2)@3        ; 1)
t("{x-y*z}:(1;2;)@4"    ; {x-y*z}:(1;2;)@4    ; -7)
t("{x-y*z}:(1;;3)@4"    ; {x-y*z}:(1;;3)@4    ; -11)
t("{x-y*z}:(;2;3)@4"    ; {x-y*z}:(;2;3)@4    ; -2)
t("{x-y*z}:(1;;)@[4 5]" ; {x-y*z}:(1;;)@[4 5] ; -19)
t("{x-y*z}:(;2;)@[4 5]" ; {x-y*z}:(;2;)@[4 5] ; -6)
t("{x-y*z}:(;;3)@[4 5]" ; {x-y*z}:(;;3)@[4 5] ; -11)

f2::{x-y}
f3::{x-y*z}
t("f2(1;)@2"      ; f2(1;)@2      ; -1)
t("f2(;2)@2"      ; f2(;2)@3      ; 1)
t("f3(1;2;)@4"    ; f3(1;2;)@4    ; -7)
t("f3(1;;3)@4"    ; f3(1;;3)@4    ; -11)
t("f3(;2;3)@4"    ; f3(;2;3)@4    ; -2)
t("f3(1;;)@[4 5]" ; f3(1;;)@[4 5] ; -19)
t("f3(;2;)@[4 5]" ; f3(;2;)@[4 5] ; -6)
t("f3(;;3)@[4 5]" ; f3(;;3)@[4 5] ; -11)

:" Monad Contexts "
f::{,x}
g::{x,y}
t(",1"                ; ,1                ; [1])
t(",'[1 2 3]"         ; ,'[1 2 3]         ; [[1] [2] [3]])
t("f'[1 2 3]"         ; f'[1 2 3]         ; [[1] [2] [3]])
t("{,x}'[1 2 3]"      ; {,x}'[1 2 3]      ; [[1] [2] [3]])
t("g(;0)'[1 2 3]"     ; g(;0)'[1 2 3]     ; [[1 0] [2 0] [3 0]])
t("{x,y}(0;)'[1 2 3]" ; {x,y}(0;)'[1 2 3] ; [[0 1] [0 2] [0 3]])

:" Dyad Contexts "
f::{x,y}
g::{x,y,z}
t("1,2"                   ; 1,2                   ; [1 2])
t("0,:\[1 2 3]"           ; 0,:\[1 2 3]           ; [[0 1] [0 2] [0 3]])
t("0{x,y}[1 2 3]"         ; 0{x,y}[1 2 3]         ; [0 1 2 3])
t("0{x,y}:/[1 2 3]"       ; 0{x,y}:/[1 2 3]       ; [[1 0] [2 0] [3 0]])
t("0f[1 2 3]"             ; 0f[1 2 3]             ; [0 1 2 3])
t("9f:/[1 2 3]"           ; 9f:/[1 2 3]           ; [[1 9] [2 9] [3 9]])
t("[1 2 3]g(;0;)[4 5 6]"  ; [1 2 3]g(;0;)[4 5 6]  ; [1 2 3 0 4 5 6])
t("[1 2 3]g(;0;)'[4 5 6]" ; [1 2 3]g(;0;)'[4 5 6] ; [[1 0 4] [2 0 5] [3 0 6]])

t("1{x,y,z}(;0;)2"          ; 1{x,y,z}(;0;)2          ; [1 0 2])
t("[1 2]{x,y,z}(;0;)'[3 4]" ; [1 2]{x,y,z}(;0;)'[3 4] ; [[1 0 3] [2 0 4]])

:" Local Variables "
fv::{[a];a::1;a} ; t("fv()"     ; fv()     ; 1)
a::2             ; t("a,fv(),a" ; a,fv(),a ; [2 1 2])

:" Symbol Identity "
t(":test~:test"       ; :test~:test       ; 1)
t(":test~*[test]"     ; :test~*[test]     ; 1)
t("(*[test])~:test"   ; (*[test])~:test   ; 1)
t("(*[test])~*[test]" ; (*[test])~*[test] ; 1)
t(":{[foo bar]}?:foo" ; :{[foo bar]}?:foo ; :bar)

:" Dictionaries: in situ mutation "
D:::{};{D,x,x}'!5
t("D:::{};{D,x,x}'!5;D" ; s@<s::*'D ; [0 1 2 3 4])

:" Dictionaries: creation "
uniq::{[d];d:::{};{d,x,x}'x;d@<d::*'d}
t("uniq(!5)"  ; uniq(!5) ; [0 1 2 3 4 ])
t("uniq(!7)"  ; uniq(!7) ; [0 1 2 3 4 5 6])
t("uniq(!3)"  ; uniq(!3) ; [0 1 2])

:" Real number similarity "
s::{(x+2%x)%2}:~2
t("(s+10*.e)~s" ; (s+10*.e)~s; 1)

:" Modules "
a::0
t("a" ; a ; 0)

.module(:test)
a::1
g::{a}
f::{g()}
s::{a::x}
.module(0)

       t("a"    ; a    ; 1)
       t("g()"  ; g()  ; 1)
       t("s(2)" ; s(2) ; 2)
       t("g()"  ; g()  ; 2)
a::0 ; t("g()"  ; g()  ; 2)
g::0 ; t("f()"  ; f()  ; 2)

:" Forward reference "
fw::0
.module(:fwd)
fw::1
fwd::{fw}
fw::2
.module(0)
fw::3
t("fwd()" ; fwd() ; 2)

:" Regression tests "

a::!8192
.tc(.oc("test.tmp"));.w(a);.cc(.tc(0))
.fc(.ic("test.tmp"));t(".r" ; .r() ; a);.cc(.fc(0))
.df("test.tmp")

:[err;[];.p("ok!")]
