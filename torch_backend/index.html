
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://briangu.github.io/klongpy/torch_backend/">
      
      
        <link rel="prev" href="../python_integration/">
      
      
        <link rel="next" href="../performance/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>PyTorch Backend & Autograd - KlongPy</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pytorch-backend-and-autograd" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="KlongPy" class="md-header__button md-logo" aria-label="KlongPy" data-md-component="logo">
      
  <img src="../assets/images/klongpy_logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            KlongPy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PyTorch Backend & Autograd
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/briangu/klongpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    briangu/klongpy
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="KlongPy" class="md-nav__button md-logo" aria-label="KlongPy" data-md-component="logo">
      
  <img src="../assets/images/klongpy_logo.jpg" alt="logo">

    </a>
    KlongPy
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/briangu/klongpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    briangu/klongpy
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python_integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Python Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    PyTorch Backend & Autograd
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    PyTorch Backend & Autograd
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#enabling-the-pytorch-backend" class="md-nav__link">
    <span class="md-ellipsis">
      
        Enabling the PyTorch Backend
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      
        Backend Comparison
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Performance
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automatic-differentiation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Automatic Differentiation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Automatic Differentiation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typing-special-characters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Typing Special Characters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autograd-operator-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      
        :&gt; Autograd Operator (Recommended)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#numeric-gradient-operator" class="md-nav__link">
    <span class="md-ellipsis">
      
        ∇ Numeric Gradient Operator
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-they-work" class="md-nav__link">
    <span class="md-ellipsis">
      
        How They Work
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Examples
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-parameter-gradients" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-Parameter Gradients
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jacobian-computation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Jacobian Computation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-parameter-jacobians" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-Parameter Jacobians
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-optimizers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Custom Optimizers
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gpu-acceleration" class="md-nav__link">
    <span class="md-ellipsis">
      
        GPU Acceleration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GPU Acceleration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#device-selection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Device Selection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mps-limitations" class="md-nav__link">
    <span class="md-ellipsis">
      
        MPS Limitations
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mixing-with-python" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mixing with Python
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Best Practices
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#function-compilation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function Compilation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Function Compilation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compilefninput-compile-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        .compile(fn;input) - Compile Function
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exportfninputpath-export-computation-graph" class="md-nav__link">
    <span class="md-ellipsis">
      
        .export(fn;input;path) - Export Computation Graph
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compilexfninputoptions-extended-compilation" class="md-nav__link">
    <span class="md-ellipsis">
      
        .compilex(fn;input;options) - Extended Compilation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmodes-query-compilation-modes" class="md-nav__link">
    <span class="md-ellipsis">
      
        .cmodes() - Query Compilation Modes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compilation-mode-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      
        Compilation Mode Comparison
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backend-comparison_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Backend Comparison
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gradient-verification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gradient Verification
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Gradient Verification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gradcheckfninputs-verify-gradients" class="md-nav__link">
    <span class="md-ellipsis">
      
        .gradcheck(fn;inputs) - Verify Gradients
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Troubleshooting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytorch-backend-does-not-support-object-dtype" class="md-nav__link">
    <span class="md-ellipsis">
      
        "PyTorch backend does not support object dtype"
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mps-float64-errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        MPS float64 errors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slow-small-array-operations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Slow small array operations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchcompile-errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        torch.compile errors
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../performance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Performance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Operators
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../repl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    REPL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Data & Systems
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Data & Systems
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fast_columnar_database/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fast Columnar Database
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../table_and_key_value_stores/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Table & Key-Value Store
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ipc_capabilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IPC Capabilities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../web_server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Web Server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../websockets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    WebSockets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../timer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Timers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#enabling-the-pytorch-backend" class="md-nav__link">
    <span class="md-ellipsis">
      
        Enabling the PyTorch Backend
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      
        Backend Comparison
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Performance
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automatic-differentiation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Automatic Differentiation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Automatic Differentiation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typing-special-characters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Typing Special Characters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autograd-operator-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      
        :&gt; Autograd Operator (Recommended)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#numeric-gradient-operator" class="md-nav__link">
    <span class="md-ellipsis">
      
        ∇ Numeric Gradient Operator
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-they-work" class="md-nav__link">
    <span class="md-ellipsis">
      
        How They Work
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Examples
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-parameter-gradients" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-Parameter Gradients
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jacobian-computation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Jacobian Computation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-parameter-jacobians" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-Parameter Jacobians
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-optimizers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Custom Optimizers
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gpu-acceleration" class="md-nav__link">
    <span class="md-ellipsis">
      
        GPU Acceleration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GPU Acceleration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#device-selection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Device Selection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mps-limitations" class="md-nav__link">
    <span class="md-ellipsis">
      
        MPS Limitations
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mixing-with-python" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mixing with Python
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Best Practices
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#function-compilation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function Compilation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Function Compilation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compilefninput-compile-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        .compile(fn;input) - Compile Function
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exportfninputpath-export-computation-graph" class="md-nav__link">
    <span class="md-ellipsis">
      
        .export(fn;input;path) - Export Computation Graph
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compilexfninputoptions-extended-compilation" class="md-nav__link">
    <span class="md-ellipsis">
      
        .compilex(fn;input;options) - Extended Compilation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmodes-query-compilation-modes" class="md-nav__link">
    <span class="md-ellipsis">
      
        .cmodes() - Query Compilation Modes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compilation-mode-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      
        Compilation Mode Comparison
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backend-comparison_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Backend Comparison
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gradient-verification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gradient Verification
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Gradient Verification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gradcheckfninputs-verify-gradients" class="md-nav__link">
    <span class="md-ellipsis">
      
        .gradcheck(fn;inputs) - Verify Gradients
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Troubleshooting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytorch-backend-does-not-support-object-dtype" class="md-nav__link">
    <span class="md-ellipsis">
      
        "PyTorch backend does not support object dtype"
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mps-float64-errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        MPS float64 errors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slow-small-array-operations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Slow small array operations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchcompile-errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        torch.compile errors
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="pytorch-backend-and-autograd">PyTorch Backend and Autograd<a class="headerlink" href="#pytorch-backend-and-autograd" title="Permanent link">&para;</a></h1>
<p>KlongPy supports multiple array backends. The PyTorch backend enables GPU acceleration and automatic differentiation (autograd) for gradient-based computations.</p>
<h2 id="enabling-the-pytorch-backend">Enabling the PyTorch Backend<a class="headerlink" href="#enabling-the-pytorch-backend" title="Permanent link">&para;</a></h2>
<p>Set the <code>USE_TORCH</code> environment variable:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Enable torch backend</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nv">USE_TORCH</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>python<span class="w"> </span>your_script.py
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Or in the REPL</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nv">USE_TORCH</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>kgpy
</code></pre></div>
<p>You can also set:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nv">KLONGPY_BACKEND</span><span class="o">=</span>torch
</code></pre></div>
<p>Or programmatically:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;USE_TORCH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">klongpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">KlongInterpreter</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">klong</span> <span class="o">=</span> <span class="n">KlongInterpreter</span><span class="p">()</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">klong</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>  <span class="c1"># &#39;torch&#39;</span>
</code></pre></div>
<p>You can also pass the backend directly:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">klongpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">KlongInterpreter</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">klong</span> <span class="o">=</span> <span class="n">KlongInterpreter</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;torch&quot;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="backend-comparison">Backend Comparison<a class="headerlink" href="#backend-comparison" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Feature</th>
<th>NumPy Backend</th>
<th>PyTorch Backend</th>
</tr>
</thead>
<tbody>
<tr>
<td>Default</td>
<td>Yes</td>
<td>No (requires USE_TORCH=1 or KLONGPY_BACKEND=torch)</td>
</tr>
<tr>
<td>Object dtype</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td>String operations</td>
<td>Yes</td>
<td>Not supported</td>
</tr>
<tr>
<td>GPU acceleration</td>
<td>No</td>
<td>Yes (CUDA/MPS)</td>
</tr>
<tr>
<td>Autograd</td>
<td>Numeric only</td>
<td>Native autograd</td>
</tr>
<tr>
<td>Small array performance</td>
<td>Faster</td>
<td>Slightly slower</td>
</tr>
<tr>
<td>Large array performance</td>
<td>Good</td>
<td>Better (especially on GPU)</td>
</tr>
</tbody>
</table>
<h2 id="performance">Performance<a class="headerlink" href="#performance" title="Permanent link">&para;</a></h2>
<p>The torch backend excels with large arrays:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>Benchmark              NumPy      Torch      Winner
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>---------------------------------------------------------
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>vector_add_100K        0.04ms     0.08ms     NumPy (2x)
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>vector_add_1M          0.36ms     0.07ms     Torch (5x)
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>compound_expr_1M       0.61ms     0.07ms     Torch (8x)
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>grade_up_100K          0.59ms     0.19ms     Torch (3x)
</code></pre></div>
<p>For small arrays (&lt;100K elements), NumPy is slightly faster due to lower dispatch overhead. For larger arrays, torch wins significantly.</p>
<h2 id="automatic-differentiation">Automatic Differentiation<a class="headerlink" href="#automatic-differentiation" title="Permanent link">&para;</a></h2>
<p>KlongPy provides several gradient and differentiation operators:</p>
<h3 id="typing-special-characters">Typing Special Characters<a class="headerlink" href="#typing-special-characters" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Name</th>
<th>Mac</th>
<th>Windows</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>∇</code></td>
<td>Nabla</td>
<td>Character Viewer (Ctrl+Cmd+Space)</td>
<td>Alt+8711</td>
</tr>
<tr>
<td><code>∂</code></td>
<td>Partial</td>
<td><strong>Option + d</strong></td>
<td>Alt+8706</td>
</tr>
</tbody>
</table>
<p>On Mac, <code>∂</code> can be typed directly with <strong>Option + d</strong>. For <code>∇</code>, use the Character Viewer or copy-paste.</p>
<h3 id="autograd-operator-recommended"><code>:&gt;</code> Autograd Operator (Recommended)<a class="headerlink" href="#autograd-operator-recommended" title="Permanent link">&para;</a></h3>
<p>The <code>:&gt;</code> operator uses PyTorch autograd for exact gradients:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>f::{x^2}         :&quot; Define f(x) = x^2
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>f:&gt;3             :&quot; Compute f&#39;(3) = 6.0
</code></pre></div>
<p>The syntax is <code>function:&gt;point</code> where:
- <code>function</code> is a scalar-valued function (must return a single number)
- <code>point</code> is the input at which to compute the gradient</p>
<h3 id="numeric-gradient-operator"><code>∇</code> Numeric Gradient Operator<a class="headerlink" href="#numeric-gradient-operator" title="Permanent link">&para;</a></h3>
<p>The <code>∇</code> operator <strong>always</strong> uses numeric differentiation (finite differences), regardless of backend:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>f::{x^2}         :&quot; Define f(x) = x^2
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>3∇f              :&quot; Compute f&#39;(3) ≈ 6.0
</code></pre></div>
<p>The syntax is <code>point∇function</code> (note: reversed order from <code>:&gt;</code>).</p>
<h3 id="how-they-work">How They Work<a class="headerlink" href="#how-they-work" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Operator</th>
<th>Method</th>
<th>Precision</th>
<th>Speed</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:&gt;</code> with torch</td>
<td>PyTorch autograd</td>
<td>Exact</td>
<td>Fast</td>
</tr>
<tr>
<td><code>:&gt;</code> without torch</td>
<td>Numeric</td>
<td>~1e-6 error</td>
<td>Slower</td>
</tr>
<tr>
<td><code>∇</code> (any backend)</td>
<td>Always numeric</td>
<td>~1e-6 error</td>
<td>Slower</td>
</tr>
</tbody>
</table>
<p>With the torch backend (<code>USE_TORCH=1</code> or <code>KLONGPY_BACKEND=torch</code>), prefer <code>:&gt;</code> for:
- Exact gradients (no floating-point approximation error)
- Complex computational graphs
- Better performance on large arrays</p>
<h3 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h3>
<p><strong>Scalar function:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>f::{x^3}          :&quot; f(x) = x^3
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>f:&gt;2              :&quot; f&#39;(2) = 3*4 = 12.0
</code></pre></div></p>
<p><strong>Polynomial:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>p::{((3*x^4)-(2*x^2))+x}   :&quot; p(x) = 3x^4 - 2x^2 + x
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>p:&gt;1                        :&quot; p&#39;(1) = 12 - 4 + 1 = 9.0
</code></pre></div></p>
<p><strong>Vector function (sum of squares):</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>g::{+/x^2}             :&quot; g(x) = sum(x_i^2)
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>g:&gt;[1.0 2.0 3.0]       :&quot; [2 4 6] = 2*x
</code></pre></div></p>
<p><strong>Gradient descent:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>f::{x^2}
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>x::5.0
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>lr::0.1
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>:&quot; Update rule: x = x - lr * grad
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>x::x-(lr*f:&gt;x)
</code></pre></div></p>
<h3 id="multi-parameter-gradients">Multi-Parameter Gradients<a class="headerlink" href="#multi-parameter-gradients" title="Permanent link">&para;</a></h3>
<p>Compute gradients for multiple parameters simultaneously using a list of symbols:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>w::2.0
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>b::3.0
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>loss::{(w^2)+(b^2)}
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>:&quot; Compute gradients for both w and b
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>grads::loss:&gt;[w b]    :&quot; [4.0 6.0] = [2w, 2b]
</code></pre></div>
<p>This is especially useful for neural network training:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>w::1.0
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>b::0.0
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>X::[1 2 3]
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>Y::[3 5 7]
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>:&quot; MSE loss
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>loss::{(+/((w*X)+b-Y)^2)%3}
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>:&quot; Compute both gradients in one call
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>grads::loss:&gt;[w b]
</code></pre></div>
<h3 id="jacobian-computation">Jacobian Computation<a class="headerlink" href="#jacobian-computation" title="Permanent link">&para;</a></h3>
<p>Compute the Jacobian matrix (matrix of partial derivatives) using the <code>∂</code> operator or <code>.jacobian()</code> function:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>f::{x^2}                 :&quot; Element-wise square
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>:&quot; Using ∂ operator (point∂function)
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>[1 2]∂f                  :&quot; [[2 0] [0 4]] diagonal matrix
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>:&quot; Using .jacobian() function
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>.jacobian(f;[1 2])       :&quot; Same result
</code></pre></div>
<p>For vector-valued functions f: R^n -&gt; R^m, the Jacobian is an m x n matrix where J[i,j] = df_i/dx_j.</p>
<h3 id="multi-parameter-jacobians">Multi-Parameter Jacobians<a class="headerlink" href="#multi-parameter-jacobians" title="Permanent link">&para;</a></h3>
<p>Just like gradients, you can compute Jacobians with respect to multiple parameters using a list of symbols:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>w::[1.0 2.0]
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>b::[3.0 4.0]
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>f::{w^2}                 :&quot; Returns [w0^2, w1^2]
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>:&quot; Compute Jacobians for both w and b
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>jacobians::[w b]∂f       :&quot; Returns [J_w, J_b]
</code></pre></div>
<p>This returns a list of Jacobian matrices, one per parameter. Useful for analyzing how vector-valued functions depend on multiple parameter sets.</p>
<h3 id="custom-optimizers">Custom Optimizers<a class="headerlink" href="#custom-optimizers" title="Permanent link">&para;</a></h3>
<p>KlongPy provides the gradient primitives (<code>:&gt;</code>, <code>∂</code>, <code>.jacobian()</code>). For optimizers, use the example classes in <code>examples/autograd/optimizers.py</code> which you can copy to your project and customize.</p>
<p><strong>Manual gradient descent (no optimizer needed):</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>w::10.0
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>loss::{w^2}
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>lr::0.1
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>:&quot; Update rule: w = w - lr * gradient
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>{w::w-(lr*loss:&gt;w)}&#39;!50
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>w                        :&quot; Close to 0
</code></pre></div></p>
<p><strong>Using a custom optimizer class:</strong></p>
<ol>
<li>Copy <code>examples/autograd/optimizers.py</code> to your project directory</li>
<li>Import with <code>.pyf()</code>:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>:&quot; Import the optimizer class
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>.pyf(&quot;optimizers&quot;;&quot;SGDOptimizer&quot;)
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>:&quot; Setup parameters and loss
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>w::10.0
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>loss::{w^2}
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>:&quot; Create optimizer with learning rate 0.1
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>opt::SGDOptimizer(klong;[&quot;w&quot;];:{[&quot;lr&quot; 0.1]})
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>:&quot; Run optimization steps
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>{opt(loss)}&#39;!50
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>w                        :&quot; Close to 0
</code></pre></div>
<p><strong>Available example optimizers:</strong>
- <code>SGDOptimizer</code> - Stochastic Gradient Descent with optional momentum
- <code>AdamOptimizer</code> - Adam optimizer with adaptive learning rates</p>
<p><strong>SGD with momentum:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>.pyf(&quot;optimizers&quot;;&quot;SGDOptimizer&quot;)
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>opt::SGDOptimizer(klong;[&quot;w&quot;];:{[&quot;lr&quot; 0.01 &quot;momentum&quot; 0.9]})
</code></pre></div></p>
<p><strong>Adam optimizer:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>.pyf(&quot;optimizers&quot;;&quot;AdamOptimizer&quot;)
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>opt::AdamOptimizer(klong;[&quot;w&quot; &quot;b&quot;];:{[&quot;lr&quot; 0.001]})
</code></pre></div></p>
<p><strong>Training loop example:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>.pyf(&quot;optimizers&quot;;&quot;AdamOptimizer&quot;)
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>w::1.0;b::0.0
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>X::[1 2 3];Y::[3 5 7]
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>loss::{(+/((w*X)+b-Y)^2)%3}
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>opt::AdamOptimizer(klong;[&quot;w&quot; &quot;b&quot;];:{[&quot;lr&quot; 0.1]})
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>:&quot; Train for 500 steps
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>{opt(loss)}&#39;!500
</code></pre></div></p>
<p><strong>Creating your own optimizer:</strong></p>
<p>The example optimizers use <code>multi_grad_of_fn</code> from <code>klongpy.autograd</code> to compute gradients for multiple parameters. Copy and modify the optimizer classes to implement custom update rules (RMSprop, AdaGrad, learning rate schedules, etc.).</p>
<h2 id="gpu-acceleration">GPU Acceleration<a class="headerlink" href="#gpu-acceleration" title="Permanent link">&para;</a></h2>
<p>When CUDA or Apple MPS is available, tensors automatically use GPU:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">klongpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">KlongInterpreter</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;USE_TORCH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="n">klong</span> <span class="o">=</span> <span class="n">KlongInterpreter</span><span class="p">()</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">klong</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>  <span class="c1"># &#39;cuda:0&#39;, &#39;mps:0&#39;, or &#39;cpu&#39;</span>
</code></pre></div>
<h3 id="device-selection">Device Selection<a class="headerlink" href="#device-selection" title="Permanent link">&para;</a></h3>
<p>The backend automatically selects the best available device:
1. CUDA (NVIDIA GPU) - if available
2. MPS (Apple Silicon) - if available
3. CPU - fallback</p>
<h3 id="mps-limitations">MPS Limitations<a class="headerlink" href="#mps-limitations" title="Permanent link">&para;</a></h3>
<p>Apple's MPS backend has some limitations:
- No float64 support (uses float32)
- Some operations fall back to CPU</p>
<h2 id="mixing-with-python">Mixing with Python<a class="headerlink" href="#mixing-with-python" title="Permanent link">&para;</a></h2>
<p>Access torch tensors directly:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">klongpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">KlongInterpreter</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;USE_TORCH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="n">klong</span> <span class="o">=</span> <span class="n">KlongInterpreter</span><span class="p">()</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="c1"># KlongPy operations return torch tensors</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="n">result</span> <span class="o">=</span> <span class="n">klong</span><span class="p">(</span><span class="s1">&#39;2*1+!1000000&#39;</span><span class="p">)</span>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>  <span class="c1"># &lt;class &#39;torch.Tensor&#39;&gt;</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>  <span class="c1"># cuda:0, mps:0, or cpu</span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="c1"># Convert to numpy when needed</span>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="n">np_result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</code></pre></div>
<h2 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Use torch for large computations</strong>: Switch to torch backend for arrays &gt;100K elements</p>
</li>
<li>
<p><strong>Keep data as tensors</strong>: Avoid unnecessary conversions between numpy and torch</p>
</li>
<li>
<p><strong>Batch operations</strong>: Combine operations to minimize dispatch overhead</p>
</li>
<li>
<p><strong>Use autograd for gradients</strong>: Native autograd is faster and more accurate than numeric differentiation</p>
</li>
</ol>
<h2 id="function-compilation">Function Compilation<a class="headerlink" href="#function-compilation" title="Permanent link">&para;</a></h2>
<p>The torch backend supports compiling Klong functions for optimized execution using <code>torch.compile</code>:</p>
<h3 id="compilefninput-compile-function"><code>.compile(fn;input)</code> - Compile Function<a class="headerlink" href="#compilefninput-compile-function" title="Permanent link">&para;</a></h3>
<p>Compiles a function for faster execution:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>f::{x^2}
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>cf::.compile(f;3.0)      :&quot; Returns compiled function
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>cf(5.0)                   :&quot; 25.0 (optimized)
</code></pre></div>
<p>The compiled function runs significantly faster for complex computations.</p>
<h3 id="exportfninputpath-export-computation-graph"><code>.export(fn;input;path)</code> - Export Computation Graph<a class="headerlink" href="#exportfninputpath-export-computation-graph" title="Permanent link">&para;</a></h3>
<p>Exports the function's computation graph to a file for inspection:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>f::{(x^3)+(2*x^2)+x}
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>info::.export(f;2.0;&quot;model.pt2&quot;)
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>.p(info@&quot;graph&quot;)         :&quot; Print computation graph
</code></pre></div>
<p>Returns a dictionary with:
- <code>"compiled_fn"</code> - The compiled function
- <code>"export_path"</code> - Path where graph was saved
- <code>"graph"</code> - String representation of computation graph</p>
<p>The exported <code>.pt2</code> file can be loaded with <code>torch.export.load()</code> in Python.</p>
<h3 id="compilexfninputoptions-extended-compilation"><code>.compilex(fn;input;options)</code> - Extended Compilation<a class="headerlink" href="#compilexfninputoptions-extended-compilation" title="Permanent link">&para;</a></h3>
<p>Compile with advanced options for mode and backend:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>f::{x^2}
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>:&quot; Fast compilation for development
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>cf::.compilex(f;3.0;:{[&quot;mode&quot; &quot;reduce-overhead&quot;]})
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>:&quot; Maximum optimization for production
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>cf::.compilex(f;3.0;:{[&quot;mode&quot; &quot;max-autotune&quot;]})
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>:&quot; Debug mode (no compilation)
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>cf::.compilex(f;3.0;:{[&quot;backend&quot; &quot;eager&quot;]})
</code></pre></div>
<p><strong>Options dictionary:</strong>
- <code>"mode"</code> - Compilation mode (see table below)
- <code>"backend"</code> - Compilation backend (see table below)
- <code>"fullgraph"</code> - Set to 1 to require full graph compilation
- <code>"dynamic"</code> - Set to 1 for dynamic shapes, 0 for static</p>
<h3 id="cmodes-query-compilation-modes"><code>.cmodes()</code> - Query Compilation Modes<a class="headerlink" href="#cmodes-query-compilation-modes" title="Permanent link">&para;</a></h3>
<p>Get information about available modes and backends:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>info::.cmodes()
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>.p(info@&quot;modes&quot;)          :&quot; Available compilation modes
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>.p(info@&quot;backends&quot;)       :&quot; Available backends
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>.p(info@&quot;recommendations&quot;) :&quot; Suggested settings
</code></pre></div>
<h3 id="compilation-mode-comparison">Compilation Mode Comparison<a class="headerlink" href="#compilation-mode-comparison" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Mode</th>
<th>Compile Time</th>
<th>Runtime Speed</th>
<th>Best For</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>default</code></td>
<td>Medium</td>
<td>Good</td>
<td>General use</td>
</tr>
<tr>
<td><code>reduce-overhead</code></td>
<td>Fast</td>
<td>Moderate</td>
<td>Development/testing</td>
</tr>
<tr>
<td><code>max-autotune</code></td>
<td>Slow</td>
<td>Best</td>
<td>Production</td>
</tr>
</tbody>
</table>
<h3 id="backend-comparison_1">Backend Comparison<a class="headerlink" href="#backend-comparison_1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Backend</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>inductor</code></td>
<td>Default - C++/Triton code generation (fastest)</td>
</tr>
<tr>
<td><code>eager</code></td>
<td>No compilation - runs original Python (debugging)</td>
</tr>
<tr>
<td><code>aot_eager</code></td>
<td>Ahead-of-time eager (debugging + autograd)</td>
</tr>
<tr>
<td><code>cudagraphs</code></td>
<td>CUDA graphs - reduces GPU kernel launch overhead</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> Compilation requires a C++ compiler on your system. Use <code>"backend" "eager"</code> to bypass compilation for debugging. If compilation fails, an error message will indicate the issue.</p>
<h2 id="gradient-verification">Gradient Verification<a class="headerlink" href="#gradient-verification" title="Permanent link">&para;</a></h2>
<p>Use <code>.gradcheck()</code> to verify that autograd gradients are correct:</p>
<h3 id="gradcheckfninputs-verify-gradients"><code>.gradcheck(fn;inputs)</code> - Verify Gradients<a class="headerlink" href="#gradcheckfninputs-verify-gradients" title="Permanent link">&para;</a></h3>
<p>Verifies autograd gradients against numeric gradients:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>f::{x^2}
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>.gradcheck(f;3.0)        :&quot; Returns 1 if correct
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>g::{+/x^2}
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>.gradcheck(g;[1.0 2.0 3.0])  :&quot; Returns 1
</code></pre></div>
<p>This uses <code>torch.autograd.gradcheck</code> internally for rigorous verification.</p>
<p><strong>Use cases:</strong>
- Verifying custom gradient implementations
- Debugging gradient computation issues
- Ensuring numerical stability</p>
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h2>
<h3 id="pytorch-backend-does-not-support-object-dtype">"PyTorch backend does not support object dtype"<a class="headerlink" href="#pytorch-backend-does-not-support-object-dtype" title="Permanent link">&para;</a></h3>
<p>The torch backend cannot handle mixed-type arrays or nested structures with varying shapes. Use the numpy backend for these cases.</p>
<h3 id="mps-float64-errors">MPS float64 errors<a class="headerlink" href="#mps-float64-errors" title="Permanent link">&para;</a></h3>
<p>MPS doesn't support float64. The backend automatically converts to float32, but some precision-sensitive operations may behave differently.</p>
<h3 id="slow-small-array-operations">Slow small array operations<a class="headerlink" href="#slow-small-array-operations" title="Permanent link">&para;</a></h3>
<p>For arrays &lt;10K elements, numpy may be faster. Consider using numpy backend for small array workloads or batching small operations together.</p>
<h3 id="torchcompile-errors">torch.compile errors<a class="headerlink" href="#torchcompile-errors" title="Permanent link">&para;</a></h3>
<p>If <code>.compile()</code> fails with C++ errors, ensure you have:
- A C++ compiler installed (clang++ or g++)
- The required header files (may need Xcode Command Line Tools on macOS)</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": [], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>